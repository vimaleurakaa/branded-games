(function(scope){
var CryptoJS=CryptoJS||function(a){function t(){}var e={},n=e.lib={},i=n.Base={extend:function(e){t.prototype=this;var n=new t;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),(n.init.prototype=n).$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=n.WordArray=i.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=null!=n?n:4*e.length},toString:function(e){return(e||r).stringify(this)},concat:function(e){var n=this.words,t=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var s=0;s<e;s++)n[i+s>>>2]|=(t[s>>>2]>>>24-s%4*8&255)<<24-(i+s)%4*8;else if(65535<t.length)for(s=0;s<e;s+=4)n[i+s>>>2]=t[s>>>2];else n.push.apply(n,t);return this.sigBytes+=e,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=a.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var n=[],t=0;t<e;t+=4)n.push(4294967296*a.random()|0);return new u.init(n,e)}}),s=e.enc={},r=s.Hex={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],i=0;i<e;i++){var s=n[i>>>2]>>>24-i%4*8&255;t.push((s>>>4).toString(16)),t.push((15&s).toString(16))}return t.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i+=2)t[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new u.init(t,n/2)}},o=s.Latin1={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],i=0;i<e;i++)t.push(String.fromCharCode(n[i>>>2]>>>24-i%4*8&255));return t.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i++)t[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new u.init(t,n)}},d=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(o.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return o.parse(unescape(encodeURIComponent(e)))}},c=n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var n=this._data,t=n.words,i=n.sigBytes,s=this.blockSize,r=i/(4*s);if(e=(r=e?a.ceil(r):a.max((0|r)-this._minBufferSize,0))*s,i=a.min(4*e,i),e){for(var o=0;o<e;o+=s)this._doProcessBlock(t,o);o=t.splice(0,e),n.sigBytes-=i}return new u.init(o,i)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=c.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new l.HMAC.init(t,n).finalize(e)}}});var l=e.algo={};return e}(Math);!function(s){function e(e){return 4294967296*(e-(0|e))|0}for(var n=CryptoJS,t=(r=n.lib).WordArray,i=r.Hasher,r=n.algo,o=[],v=[],a=2,u=0;u<64;){var d;e:{d=a;for(var c=s.sqrt(d),l=2;l<=c;l++)if(!(d%l)){d=!1;break e}d=!0}d&&(u<8&&(o[u]=e(s.pow(a,.5))),v[u]=e(s.pow(a,1/3)),u++),a++}var m=[];r=r.SHA256=i.extend({_doReset:function(){this._hash=new t.init(o.slice(0))},_doProcessBlock:function(e,n){for(var t=this._hash.words,i=t[0],s=t[1],r=t[2],o=t[3],a=t[4],u=t[5],d=t[6],c=t[7],l=0;l<64;l++){if(l<16)m[l]=0|e[n+l];else{var f=m[l-15],g=m[l-2];m[l]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+m[l-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+m[l-16]}f=c+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&d)+v[l]+m[l],g=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&s^i&r^s&r),c=d,d=u,u=a,a=o+f|0,o=r,r=s,s=i,i=f+g|0}t[0]=t[0]+i|0,t[1]=t[1]+s|0,t[2]=t[2]+r|0,t[3]=t[3]+o|0,t[4]=t[4]+a|0,t[5]=t[5]+u|0,t[6]=t[6]+d|0,t[7]=t[7]+c|0},_doFinalize:function(){var e=this._data,n=e.words,t=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(64+i>>>9<<4)]=s.floor(t/4294967296),n[15+(64+i>>>9<<4)]=t,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=i._createHelper(r),n.HmacSHA256=i._createHmacHelper(r)}(Math),function(){var d=CryptoJS.enc.Utf8;CryptoJS.algo.HMAC=CryptoJS.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=d.parse(n));var t=e.blockSize,i=4*t;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),r=this._iKey=n.clone(),o=s.words,a=r.words,u=0;u<t;u++)o[u]^=1549556828,a[u]^=909522486;s.sigBytes=r.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var n=this._hasher;return e=n.finalize(e),n.reset(),n.finalize(this._oKey.clone().concat(e))}})}(),function(){var u=CryptoJS.lib.WordArray;CryptoJS.enc.Base64={stringify:function(e){var n=e.words,t=e.sigBytes,i=this._map;e.clamp(),e=[];for(var s=0;s<t;s+=3)for(var r=(n[s>>>2]>>>24-s%4*8&255)<<16|(n[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|n[s+2>>>2]>>>24-(s+2)%4*8&255,o=0;o<4&&s+.75*o<t;o++)e.push(i.charAt(r>>>6*(3-o)&63));if(n=i.charAt(64))for(;e.length%4;)e.push(n);return e.join("")},parse:function(e){var n=e.length,t=this._map;!(i=t.charAt(64))||-1!=(i=e.indexOf(i))&&(n=i);for(var i=[],s=0,r=0;r<n;r++)if(r%4){var o=t.indexOf(e.charAt(r-1))<<r%4*2,a=t.indexOf(e.charAt(r))>>>6-r%4*2;i[s>>>2]|=(o|a)<<24-s%4*8,s++}return u.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){var n,t,i,s,r,o;(n=e.EGAErrorSeverity||(e.EGAErrorSeverity={}))[n.Undefined=0]="Undefined",n[n.Debug=1]="Debug",n[n.Info=2]="Info",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",(t=e.EGAProgressionStatus||(e.EGAProgressionStatus={}))[t.Undefined=0]="Undefined",t[t.Start=1]="Start",t[t.Complete=2]="Complete",t[t.Fail=3]="Fail",(i=e.EGAResourceFlowType||(e.EGAResourceFlowType={}))[i.Undefined=0]="Undefined",i[i.Source=1]="Source",i[i.Sink=2]="Sink",s=e.http||(e.http={}),(r=s.EGASdkErrorType||(s.EGASdkErrorType={}))[r.Undefined=0]="Undefined",r[r.Rejected=1]="Rejected",(o=s.EGAHTTPApiResponse||(s.EGAHTTPApiResponse={}))[o.NoResponse=0]="NoResponse",o[o.BadResponse=1]="BadResponse",o[o.RequestTimeout=2]="RequestTimeout",o[o.JsonEncodeFailed=3]="JsonEncodeFailed",o[o.JsonDecodeFailed=4]="JsonDecodeFailed",o[o.InternalServerError=5]="InternalServerError",o[o.BadRequest=6]="BadRequest",o[o.Unauthorized=7]="Unauthorized",o[o.UnknownResponseCode=8]="UnknownResponseCode",o[o.Ok=9]="Ok",o[o.Created=10]="Created"}(gameanalytics=gameanalytics||{});var gameanalytics,EGAErrorSeverity=gameanalytics.EGAErrorSeverity,EGAProgressionStatus=gameanalytics.EGAProgressionStatus,EGAResourceFlowType=gameanalytics.EGAResourceFlowType;!function(e){!function(e){var t,n;(n=t=t||{})[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Debug=3]="Debug";var i=(s.setInfoLog=function(e){s.instance.infoLogEnabled=e},s.setVerboseLog=function(e){s.instance.infoLogVerboseEnabled=e},s.i=function(e){if(s.instance.infoLogEnabled){var n="Info/"+s.Tag+": "+e;s.instance.sendNotificationMessage(n,t.Info)}},s.w=function(e){var n="Warning/"+s.Tag+": "+e;s.instance.sendNotificationMessage(n,t.Warning)},s.e=function(e){var n="Error/"+s.Tag+": "+e;s.instance.sendNotificationMessage(n,t.Error)},s.ii=function(e){if(s.instance.infoLogVerboseEnabled){var n="Verbose/"+s.Tag+": "+e;s.instance.sendNotificationMessage(n,t.Info)}},s.d=function(e){if(s.debugEnabled){var n="Debug/"+s.Tag+": "+e;s.instance.sendNotificationMessage(n,t.Debug)}},s.prototype.sendNotificationMessage=function(e,n){switch(n){case t.Error:console.error(e);break;case t.Warning:console.warn(e);break;case t.Debug:"function"==typeof console.debug?console.debug(e):console.log(e);break;case t.Info:console.log(e)}},s.instance=new s,s.Tag="GameAnalytics",s);function s(){s.debugEnabled=!1}e.GALogger=i}(e.logging||(e.logging={}))}(gameanalytics=gameanalytics||{}),function(e){var n,d,t;function c(){}n=e.utilities||(e.utilities={}),d=e.logging.GALogger,c.getHmac=function(e,n){var t=CryptoJS.HmacSHA256(n,e);return CryptoJS.enc.Base64.stringify(t)},c.stringMatch=function(e,n){return!(!e||!n)&&n.test(e)},c.joinStringArray=function(e,n){for(var t="",i=0,s=e.length;i<s;i++)0<i&&(t+=n),t+=e[i];return t},c.stringArrayContainsString=function(e,n){if(0===e.length)return!1;for(var t in e)if(e[t]===n)return!0;return!1},c.encode64=function(e){e=encodeURI(e);for(var n,t,i,s,r,o="",a=0,u=0,d=0;i=(n=e.charCodeAt(d++))>>2,s=(3&n)<<4|(t=e.charCodeAt(d++))>>4,r=(15&t)<<2|(a=e.charCodeAt(d++))>>6,u=63&a,isNaN(t)?r=u=64:isNaN(a)&&(u=64),o=o+c.keyStr.charAt(i)+c.keyStr.charAt(s)+c.keyStr.charAt(r)+c.keyStr.charAt(u),n=t=a=0,i=s=r=u=0,d<e.length;);return o},c.decode64=function(e){var n,t,i,s,r="",o=0,a=0,u=0;for(/[^A-Za-z0-9\+\/\=]/g.exec(e)&&d.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");n=c.keyStr.indexOf(e.charAt(u++))<<2|(i=c.keyStr.indexOf(e.charAt(u++)))>>4,t=(15&i)<<4|(s=c.keyStr.indexOf(e.charAt(u++)))>>2,o=(3&s)<<6|(a=c.keyStr.indexOf(e.charAt(u++))),r+=String.fromCharCode(n),64!=s&&(r+=String.fromCharCode(t)),64!=a&&(r+=String.fromCharCode(o)),n=t=o=0,i=s=a=0,u<e.length;);return decodeURI(r)},c.timeIntervalSince1970=function(){var e=new Date;return Math.round(e.getTime()/1e3)},c.createGuid=function(){return(c.s4()+c.s4()+"-"+c.s4()+"-4"+c.s4().substr(0,3)+"-"+c.s4()+"-"+c.s4()+c.s4()+c.s4()).toLowerCase()},c.s4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},c.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=c,n.GAUtilities=t}(gameanalytics=gameanalytics||{}),function(a){var e,u,i,d,n;function c(){}e=a.validators||(a.validators={}),u=a.logging.GALogger,i=a.http.EGASdkErrorType,d=a.utilities.GAUtilities,c.validateBusinessEvent=function(e,n,t,i,s){return c.validateCurrency(e)?n<0?(u.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: "+n),!1):c.validateShortString(t,!0)?c.validateEventPartLength(i,!1)?c.validateEventPartCharacters(i)?c.validateEventPartLength(s,!1)?!!c.validateEventPartCharacters(s)||(u.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+s),!1):(u.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: "+s),!1):(u.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+i),!1):(u.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: "+i),!1):(u.w("Validation fail - business event - cartType. Cannot be above 32 length. String: "+t),!1):(u.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: "+e),!1)},c.validateResourceEvent=function(e,n,t,i,s,r,o){return e==a.EGAResourceFlowType.Undefined?(u.w("Validation fail - resource event - flowType: Invalid flow type."),!1):n?d.stringArrayContainsString(r,n)?0<t?i?c.validateEventPartLength(i,!1)?c.validateEventPartCharacters(i)?d.stringArrayContainsString(o,i)?c.validateEventPartLength(s,!1)?!!c.validateEventPartCharacters(s)||(u.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+s),!1):(u.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: "+s),!1):(u.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: "+i),!1):(u.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+i),!1):(u.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: "+i),!1):(u.w("Validation fail - resource event - itemType: Cannot be (null)"),!1):(u.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: "+t),!1):(u.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: "+n),!1):(u.w("Validation fail - resource event - currency: Cannot be (null)"),!1)},c.validateProgressionEvent=function(e,n,t,i){if(e==a.EGAProgressionStatus.Undefined)return u.w("Validation fail - progression event: Invalid progression status."),!1;if(i&&!t&&n)return u.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."),!1;if(t&&!n)return u.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"),!1;if(!n)return u.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"),!1;if(!c.validateEventPartLength(n,!1))return u.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: "+n),!1;if(!c.validateEventPartCharacters(n))return u.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+n),!1;if(t){if(!c.validateEventPartLength(t,!0))return u.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: "+t),!1;if(!c.validateEventPartCharacters(t))return u.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+t),!1}if(i){if(!c.validateEventPartLength(i,!0))return u.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: "+i),!1;if(!c.validateEventPartCharacters(i))return u.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+i),!1}return!0},c.validateDesignEvent=function(e,n){return c.validateEventIdLength(e)?!!c.validateEventIdCharacters(e)||(u.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: "+e),!1):(u.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 32 characters or less. String: "+e),!1)},c.validateErrorEvent=function(e,n){return e==a.EGAErrorSeverity.Undefined?(u.w("Validation fail - error event - severity: Severity was unsupported value."),!1):!!c.validateLongString(n,!0)||(u.w("Validation fail - error event - message: Message cannot be above 8192 characters."),!1)},c.validateSdkErrorEvent=function(e,n,t){return!(!c.validateKeys(e,n)||t===i.Undefined&&(u.w("Validation fail - sdk error event - type: Type was unsupported value."),1))},c.validateKeys=function(e,n){return!(!d.stringMatch(e,/^[A-z0-9]{32}$/)||!d.stringMatch(n,/^[A-z0-9]{40}$/))},c.validateCurrency=function(e){return!!e&&!!d.stringMatch(e,/^[A-Z]{3}$/)},c.validateEventPartLength=function(e,n){return!(!n||e)||!!e&&!(64<e.length)},c.validateEventPartCharacters=function(e){return!!d.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/)},c.validateEventIdLength=function(e){return!!e&&!!d.stringMatch(e,/^[^:]{1,64}(?::[^:]{1,64}){0,4}$/)},c.validateEventIdCharacters=function(e){return!!e&&!!d.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/)},c.validateAndCleanInitRequestResponse=function(n,e){if(null==n)return u.w("validateInitRequestResponse failed - no response dictionary."),null;var t={};try{var i=n.server_ts;if(!(0<i))return u.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."),null;t.server_ts=i}catch(e){return u.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type="+typeof n.server_ts+", value="+n.server_ts+", "+e),null}if(e){try{var s=n.configs;t.configs=s}catch(e){return u.w("validateInitRequestResponse failed - invalid type in 'configs' field. type="+typeof n.configs+", value="+n.configs+", "+e),null}try{var r=n.configs_hash;t.configs_hash=r}catch(e){return u.w("validateInitRequestResponse failed - invalid type in 'configs_hash' field. type="+typeof n.configs_hash+", value="+n.configs_hash+", "+e),null}try{var o=n.ab_id;t.ab_id=o}catch(e){return u.w("validateInitRequestResponse failed - invalid type in 'ab_id' field. type="+typeof n.ab_id+", value="+n.ab_id+", "+e),null}try{var a=n.ab_variant_id;t.ab_variant_id=a}catch(e){return u.w("validateInitRequestResponse failed - invalid type in 'ab_variant_id' field. type="+typeof n.ab_variant_id+", value="+n.ab_variant_id+", "+e),null}}return t},c.validateBuild=function(e){return!!c.validateShortString(e,!1)},c.validateSdkWrapperVersion=function(e){return!!d.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)},c.validateEngineVersion=function(e){return!(!e||!d.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/))},c.validateUserId=function(e){return!!c.validateString(e,!1)||(u.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."),!1)},c.validateShortString=function(e,n){return!(!n||e)||!(!e||32<e.length)},c.validateString=function(e,n){return!(!n||e)||!(!e||64<e.length)},c.validateLongString=function(e,n){return!(!n||e)||!(!e||8192<e.length)},c.validateConnectionType=function(e){return d.stringMatch(e,/^(wwan|wifi|lan|offline)$/)},c.validateCustomDimensions=function(e){return c.validateArrayOfStrings(20,32,!1,"custom dimensions",e)},c.validateResourceCurrencies=function(e){if(!c.validateArrayOfStrings(20,64,!1,"resource currencies",e))return!1;for(var n=0;n<e.length;++n)if(!d.stringMatch(e[n],/^[A-Za-z]+$/))return u.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: "+e[n]),!1;return!0},c.validateResourceItemTypes=function(e){if(!c.validateArrayOfStrings(20,32,!1,"resource item types",e))return!1;for(var n=0;n<e.length;++n)if(!c.validateEventPartCharacters(e[n]))return u.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: "+e[n]),!1;return!0},c.validateDimension01=function(e,n){return!e||!!d.stringArrayContainsString(n,e)},c.validateDimension02=function(e,n){return!e||!!d.stringArrayContainsString(n,e)},c.validateDimension03=function(e,n){return!e||!!d.stringArrayContainsString(n,e)},c.validateArrayOfStrings=function(e,n,t,i,s){var r=i;if(r=r||"Array",!s)return u.w(r+" validation failed: array cannot be null. "),!1;if(0==t&&0==s.length)return u.w(r+" validation failed: array cannot be empty. "),!1;if(0<e&&s.length>e)return u.w(r+" validation failed: array cannot exceed "+e+" values. It has "+s.length+" values."),!1;for(var o=0;o<s.length;++o){var a=s[o]?s[o].length:0;if(0===a)return u.w(r+" validation failed: contained an empty string. Array="+JSON.stringify(s)),!1;if(0<n&&n<a)return u.w(r+" validation failed: a string exceeded max allowed length (which is: "+n+"). String was: "+s[o]),!1}return!0},c.validateClientTs=function(e){return!(e<-4294967294||4294967294<e)},n=c,e.GAValidator=n}(gameanalytics=gameanalytics||{}),function(e){!function(e){var n=function(e,n,t){this.name=e,this.value=n,this.version=t};e.NameValueVersion=n;var c=function(e,n){this.name=e,this.version=n};e.NameVersion=c;var t=(s.touch=function(){},s.getRelevantSdkVersion=function(){return s.sdkGameEngineVersion?s.sdkGameEngineVersion:s.sdkWrapperVersion},s.getConnectionType=function(){return s.connectionType},s.updateConnectionType=function(){navigator.onLine?s.connectionType="ios"===s.buildPlatform||"android"===s.buildPlatform?"wwan":"lan":s.connectionType="offline"},s.getOSVersionString=function(){return s.buildPlatform+" "+s.osVersionPair.version},s.runtimePlatformToString=function(){return s.osVersionPair.name},s.getBrowserVersionString=function(){var e,n=navigator.userAgent,t=n.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i)||[];if(0==t.length&&"ios"===s.buildPlatform)return"webkit_"+s.osVersion;if(/trident/i.test(t[1]))return"IE "+((e=/\brv[ :]+(\d+)/g.exec(n)||[])[1]||"");if("Chrome"===t[1]&&null!=(e=n.match(/\b(OPR|Edge|UBrowser)\/(\d+)/)))return e.slice(1).join(" ").replace("OPR","Opera").replace("UBrowser","UC").toLowerCase();if(t[1]&&"fbav"===t[1].toLowerCase()&&(t[1]="facebook",t[2]))return"facebook "+t[2];var i=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"];return null!=(e=n.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),i.join(" ").toLowerCase()},s.getDeviceModel=function(){return"unknown"},s.getDeviceManufacturer=function(){return"unknown"},s.matchItem=function(e,n){var t,i,s,r,o=new c("unknown","0.0.0"),a=0,u=0;for(a=0;a<n.length;a+=1)if(new RegExp(n[a].value,"i").test(e)){if(t=new RegExp(n[a].version+"[- /:;]([\\d._]+)","i"),r="",(i=e.match(t))&&i[1]&&(s=i[1]),s){var d=s.split(/[._]+/);for(u=0;u<Math.min(d.length,3);u+=1)r+=d[u]+(u<Math.min(d.length,3)-1?".":"")}else r="0.0.0";return o.name=n[a].name,o.version=r,o}return o},s.sdkWrapperVersion="javascript 4.0.8",s.osVersionPair=s.matchItem([navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor].join(" "),[new n("windows_phone","Windows Phone","OS"),new n("windows","Win","NT"),new n("ios","iPhone","OS"),new n("ios","iPad","OS"),new n("ios","iPod","OS"),new n("android","Android","Android"),new n("blackBerry","BlackBerry","/"),new n("mac_osx","Mac","OS X"),new n("tizen","Tizen","Tizen"),new n("linux","Linux","rv")]),s.buildPlatform=s.runtimePlatformToString(),s.deviceModel=s.getDeviceModel(),s.deviceManufacturer=s.getDeviceManufacturer(),s.osVersion=s.getOSVersionString(),s.browserVersion=s.getBrowserVersionString(),s.maxSafeInteger=Math.pow(2,53)-1,s);function s(){}e.GADevice=t}(e.device||(e.device={}))}(gameanalytics=gameanalytics||{}),function(e){var n,t;function i(e){this.deadline=e,this.ignore=!1,this.async=!1,this.running=!1,this.id=++i.idCounter}n=e.threading||(e.threading={}),i.idCounter=0,t=i,n.TimedBlock=t}(gameanalytics=gameanalytics||{}),function(e){var n,t;function i(e){this.comparer=e,this._subQueues={},this._sortedKeys=[]}n=e.threading||(e.threading={}),i.prototype.enqueue=function(e,n){-1===this._sortedKeys.indexOf(e)&&this.addQueueOfPriority(e),this._subQueues[e].push(n)},i.prototype.addQueueOfPriority=function(e){var t=this;this._sortedKeys.push(e),this._sortedKeys.sort(function(e,n){return t.comparer.compare(e,n)}),this._subQueues[e]=[]},i.prototype.peek=function(){if(this.hasItems())return this._subQueues[this._sortedKeys[0]][0];throw new Error("The queue is empty")},i.prototype.hasItems=function(){return 0<this._sortedKeys.length},i.prototype.dequeue=function(){if(this.hasItems())return this.dequeueFromHighPriorityQueue();throw new Error("The queue is empty")},i.prototype.dequeueFromHighPriorityQueue=function(){var e=this._sortedKeys[0],n=this._subQueues[e].shift();return 0===this._subQueues[e].length&&(this._sortedKeys.shift(),delete this._subQueues[e]),n},t=i,n.PriorityQueue=t}(gameanalytics=gameanalytics||{}),function(o){!function(e){var l,n,t,i,s=o.logging.GALogger;(n=l=e.EGAStoreArgsOperator||(e.EGAStoreArgsOperator={}))[n.Equal=0]="Equal",n[n.LessOrEqual=1]="LessOrEqual",n[n.NotEqual=2]="NotEqual",(i=t=e.EGAStore||(e.EGAStore={}))[i.Events=0]="Events",i[i.Sessions=1]="Sessions",i[i.Progression=2]="Progression";var r=(f.isStorageAvailable=function(){return f.storageAvailable},f.isStoreTooLargeForEvents=function(){return f.instance.eventsStore.length+f.instance.sessionsStore.length>f.MaxNumberOfEntries},f.select=function(e,n,t,i){void 0===n&&(n=[]),void 0===t&&(t=!1),void 0===i&&(i=0);var s=f.getStore(e);if(!s)return null;for(var r=[],o=0;o<s.length;++o){for(var a=s[o],u=!0,d=0;d<n.length;++d){var c=n[d];if(a[c[0]])switch(c[1]){case l.Equal:u=a[c[0]]==c[2];break;case l.LessOrEqual:u=a[c[0]]<=c[2];break;case l.NotEqual:u=a[c[0]]!=c[2];break;default:u=!1}else u=!1;if(!u)break}u&&r.push(a)}return t&&r.sort(function(e,n){return e.client_ts-n.client_ts}),0<i&&r.length>i&&(r=r.slice(0,i+1)),r},f.update=function(e,n,t){void 0===t&&(t=[]);var i=f.getStore(e);if(!i)return!1;for(var s=0;s<i.length;++s){for(var r=i[s],o=!0,a=0;a<t.length;++a){var u=t[a];if(r[u[0]])switch(u[1]){case l.Equal:o=r[u[0]]==u[2];break;case l.LessOrEqual:o=r[u[0]]<=u[2];break;case l.NotEqual:o=r[u[0]]!=u[2];break;default:o=!1}else o=!1;if(!o)break}if(o)for(a=0;a<n.length;++a){var d=n[a];r[d[0]]=d[1]}}return!0},f.delete=function(e,n){var t=f.getStore(e);if(t)for(var i=0;i<t.length;++i){for(var s=t[i],r=!0,o=0;o<n.length;++o){var a=n[o];if(s[a[0]])switch(a[1]){case l.Equal:r=s[a[0]]==a[2];break;case l.LessOrEqual:r=s[a[0]]<=a[2];break;case l.NotEqual:r=s[a[0]]!=a[2];break;default:r=!1}else r=!1;if(!r)break}r&&(t.splice(i,1),--i)}},f.insert=function(e,n,t,i){void 0===t&&(t=!1),void 0===i&&(i=null);var s=f.getStore(e);if(s)if(t){if(!i)return;for(var r=!1,o=0;o<s.length;++o){var a=s[o];if(a[i]==n[i]){for(var u in n)a[u]=n[u];r=!0;break}}r||s.push(n)}else s.push(n)},f.save=function(){f.isStorageAvailable()?(localStorage.setItem(f.KeyPrefix+f.EventsStoreKey,JSON.stringify(f.instance.eventsStore)),localStorage.setItem(f.KeyPrefix+f.SessionsStoreKey,JSON.stringify(f.instance.sessionsStore)),localStorage.setItem(f.KeyPrefix+f.ProgressionStoreKey,JSON.stringify(f.instance.progressionStore)),localStorage.setItem(f.KeyPrefix+f.ItemsStoreKey,JSON.stringify(f.instance.storeItems))):s.w("Storage is not available, cannot save.")},f.load=function(){if(f.isStorageAvailable()){try{f.instance.eventsStore=JSON.parse(localStorage.getItem(f.KeyPrefix+f.EventsStoreKey)),f.instance.eventsStore||(f.instance.eventsStore=[])}catch(e){s.w("Load failed for 'events' store. Using empty store."),f.instance.eventsStore=[]}try{f.instance.sessionsStore=JSON.parse(localStorage.getItem(f.KeyPrefix+f.SessionsStoreKey)),f.instance.sessionsStore||(f.instance.sessionsStore=[])}catch(e){s.w("Load failed for 'sessions' store. Using empty store."),f.instance.sessionsStore=[]}try{f.instance.progressionStore=JSON.parse(localStorage.getItem(f.KeyPrefix+f.ProgressionStoreKey)),f.instance.progressionStore||(f.instance.progressionStore=[])}catch(e){s.w("Load failed for 'progression' store. Using empty store."),f.instance.progressionStore=[]}try{f.instance.storeItems=JSON.parse(localStorage.getItem(f.KeyPrefix+f.ItemsStoreKey)),f.instance.storeItems||(f.instance.storeItems={})}catch(e){s.w("Load failed for 'items' store. Using empty store."),f.instance.progressionStore=[]}}else s.w("Storage is not available, cannot load.")},f.setItem=function(e,n){var t=f.KeyPrefix+e;n?f.instance.storeItems[t]=n:t in f.instance.storeItems&&delete f.instance.storeItems[t]},f.getItem=function(e){var n=f.KeyPrefix+e;return n in f.instance.storeItems?f.instance.storeItems[n]:null},f.getStore=function(e){switch(e){case t.Events:return f.instance.eventsStore;case t.Sessions:return f.instance.sessionsStore;case t.Progression:return f.instance.progressionStore;default:return s.w("GAStore.getStore(): Cannot find store: "+e),null}},f.instance=new f,f.MaxNumberOfEntries=2e3,f.KeyPrefix="GA::",f.EventsStoreKey="ga_event",f.SessionsStoreKey="ga_session",f.ProgressionStoreKey="ga_progression",f.ItemsStoreKey="ga_items",f);function f(){this.eventsStore=[],this.sessionsStore=[],this.progressionStore=[],this.storeItems={};try{"object"==typeof localStorage?(localStorage.setItem("testingLocalStorage","yes"),localStorage.removeItem("testingLocalStorage"),f.storageAvailable=!0):f.storageAvailable=!1}catch(e){}}e.GAStore=r}(o.store||(o.store={}))}(gameanalytics=gameanalytics||{}),function(e){var n,s,u,d,a,r,c,t,i;function l(){this.availableCustomDimensions01=[],this.availableCustomDimensions02=[],this.availableCustomDimensions03=[],this.availableResourceCurrencies=[],this.availableResourceItemTypes=[],this.configurations={},this.remoteConfigsListeners=[],this.sdkConfigDefault={},this.sdkConfig={},this.progressionTries={},this._isEventSubmissionEnabled=!0}n=e.state||(e.state={}),s=e.validators.GAValidator,u=e.utilities.GAUtilities,d=e.logging.GALogger,a=e.store.GAStore,r=e.device.GADevice,c=e.store.EGAStore,t=e.store.EGAStoreArgsOperator,l.setUserId=function(e){l.instance.userId=e,l.cacheIdentifier()},l.getIdentifier=function(){return l.instance.identifier},l.isInitialized=function(){return l.instance.initialized},l.setInitialized=function(e){l.instance.initialized=e},l.getSessionStart=function(){return l.instance.sessionStart},l.getSessionNum=function(){return l.instance.sessionNum},l.getTransactionNum=function(){return l.instance.transactionNum},l.getSessionId=function(){return l.instance.sessionId},l.getCurrentCustomDimension01=function(){return l.instance.currentCustomDimension01},l.getCurrentCustomDimension02=function(){return l.instance.currentCustomDimension02},l.getCurrentCustomDimension03=function(){return l.instance.currentCustomDimension03},l.getGameKey=function(){return l.instance.gameKey},l.getGameSecret=function(){return l.instance.gameSecret},l.getAvailableCustomDimensions01=function(){return l.instance.availableCustomDimensions01},l.setAvailableCustomDimensions01=function(e){s.validateCustomDimensions(e)&&(l.instance.availableCustomDimensions01=e,l.validateAndFixCurrentDimensions(),d.i("Set available custom01 dimension values: ("+u.joinStringArray(e,", ")+")"))},l.getAvailableCustomDimensions02=function(){return l.instance.availableCustomDimensions02},l.setAvailableCustomDimensions02=function(e){s.validateCustomDimensions(e)&&(l.instance.availableCustomDimensions02=e,l.validateAndFixCurrentDimensions(),d.i("Set available custom02 dimension values: ("+u.joinStringArray(e,", ")+")"))},l.getAvailableCustomDimensions03=function(){return l.instance.availableCustomDimensions03},l.setAvailableCustomDimensions03=function(e){s.validateCustomDimensions(e)&&(l.instance.availableCustomDimensions03=e,l.validateAndFixCurrentDimensions(),d.i("Set available custom03 dimension values: ("+u.joinStringArray(e,", ")+")"))},l.getAvailableResourceCurrencies=function(){return l.instance.availableResourceCurrencies},l.setAvailableResourceCurrencies=function(e){s.validateResourceCurrencies(e)&&(l.instance.availableResourceCurrencies=e,d.i("Set available resource currencies: ("+u.joinStringArray(e,", ")+")"))},l.getAvailableResourceItemTypes=function(){return l.instance.availableResourceItemTypes},l.setAvailableResourceItemTypes=function(e){s.validateResourceItemTypes(e)&&(l.instance.availableResourceItemTypes=e,d.i("Set available resource item types: ("+u.joinStringArray(e,", ")+")"))},l.getBuild=function(){return l.instance.build},l.setBuild=function(e){l.instance.build=e,d.i("Set build version: "+e)},l.getUseManualSessionHandling=function(){return l.instance.useManualSessionHandling},l.isEventSubmissionEnabled=function(){return l.instance._isEventSubmissionEnabled},l.getABTestingId=function(){return l.instance.abId},l.getABTestingVariantId=function(){return l.instance.abVariantId},l.prototype.setDefaultId=function(e){this.defaultUserId=e||"",l.cacheIdentifier()},l.getDefaultId=function(){return l.instance.defaultUserId},l.getSdkConfig=function(){var e,n=0;for(var t in l.instance.sdkConfig)0===n&&(e=t),++n;if(e&&0<n)return l.instance.sdkConfig;for(var t in n=0,l.instance.sdkConfigCached)0===n&&(e=t),++n;return e&&0<n?l.instance.sdkConfigCached:l.instance.sdkConfigDefault},l.isEnabled=function(){return!!l.instance.initAuthorized},l.setCustomDimension01=function(e){l.instance.currentCustomDimension01=e,a.setItem(l.Dimension01Key,e),d.i("Set custom01 dimension value: "+e)},l.setCustomDimension02=function(e){l.instance.currentCustomDimension02=e,a.setItem(l.Dimension02Key,e),d.i("Set custom02 dimension value: "+e)},l.setCustomDimension03=function(e){l.instance.currentCustomDimension03=e,a.setItem(l.Dimension03Key,e),d.i("Set custom03 dimension value: "+e)},l.incrementSessionNum=function(){var e=l.getSessionNum()+1;l.instance.sessionNum=e},l.incrementTransactionNum=function(){var e=l.getTransactionNum()+1;l.instance.transactionNum=e},l.incrementProgressionTries=function(e){var n=l.getProgressionTries(e)+1;l.instance.progressionTries[e]=n;var t={};t.progression=e,t.tries=n,a.insert(c.Progression,t,!0,"progression")},l.getProgressionTries=function(e){return e in l.instance.progressionTries?l.instance.progressionTries[e]:0},l.clearProgressionTries=function(e){e in l.instance.progressionTries&&delete l.instance.progressionTries[e];var n=[];n.push(["progression",t.Equal,e]),a.delete(c.Progression,n)},l.setKeys=function(e,n){l.instance.gameKey=e,l.instance.gameSecret=n},l.setManualSessionHandling=function(e){l.instance.useManualSessionHandling=e,d.i("Use manual session handling: "+e)},l.setEnabledEventSubmission=function(e){l.instance._isEventSubmissionEnabled=e},l.getEventAnnotations=function(){var e={v:2};e.user_id=l.instance.identifier,e.client_ts=l.getClientTsAdjusted(),e.sdk_version=r.getRelevantSdkVersion(),e.os_version=r.osVersion,e.manufacturer=r.deviceManufacturer,e.device=r.deviceModel,e.browser_version=r.browserVersion,e.platform=r.buildPlatform,e.session_id=l.instance.sessionId,e[l.SessionNumKey]=l.instance.sessionNum;var n=r.getConnectionType();if(s.validateConnectionType(n)&&(e.connection_type=n),r.gameEngineVersion&&(e.engine_version=r.gameEngineVersion),l.instance.configurations){var t=0;for(var i in l.instance.configurations){t++;break}0<t&&(e.configurations=l.instance.configurations)}return l.instance.abId&&(e.ab_id=l.instance.abId),l.instance.abVariantId&&(e.ab_variant_id=l.instance.abVariantId),l.instance.build&&(e.build=l.instance.build),e},l.getSdkErrorEventAnnotations=function(){var e={v:2};e.category=l.CategorySdkError,e.sdk_version=r.getRelevantSdkVersion(),e.os_version=r.osVersion,e.manufacturer=r.deviceManufacturer,e.device=r.deviceModel,e.platform=r.buildPlatform;var n=r.getConnectionType();return s.validateConnectionType(n)&&(e.connection_type=n),r.gameEngineVersion&&(e.engine_version=r.gameEngineVersion),e},l.getInitAnnotations=function(){var e={};return l.getIdentifier()||l.cacheIdentifier(),e.user_id=l.getIdentifier(),e.sdk_version=r.getRelevantSdkVersion(),e.os_version=r.osVersion,e.platform=r.buildPlatform,l.getBuild()?e.build=l.getBuild():e.build=null,e.session_num=l.getSessionNum(),e.random_salt=l.getSessionNum(),e},l.getClientTsAdjusted=function(){var e=u.timeIntervalSince1970(),n=e+l.instance.clientServerTimeOffset;return s.validateClientTs(n)?n:e},l.sessionIsStarted=function(){return 0!=l.instance.sessionStart},l.cacheIdentifier=function(){l.instance.userId?l.instance.identifier=l.instance.userId:l.instance.defaultUserId&&(l.instance.identifier=l.instance.defaultUserId)},l.ensurePersistedStates=function(){a.isStorageAvailable()&&a.load();var e=l.instance;e.setDefaultId(null!=a.getItem(l.DefaultUserIdKey)?a.getItem(l.DefaultUserIdKey):u.createGuid()),e.sessionNum=null!=a.getItem(l.SessionNumKey)?Number(a.getItem(l.SessionNumKey)):0,e.transactionNum=null!=a.getItem(l.TransactionNumKey)?Number(a.getItem(l.TransactionNumKey)):0,e.currentCustomDimension01?a.setItem(l.Dimension01Key,e.currentCustomDimension01):(e.currentCustomDimension01=null!=a.getItem(l.Dimension01Key)?a.getItem(l.Dimension01Key):"",e.currentCustomDimension01),e.currentCustomDimension02?a.setItem(l.Dimension02Key,e.currentCustomDimension02):(e.currentCustomDimension02=null!=a.getItem(l.Dimension02Key)?a.getItem(l.Dimension02Key):"",e.currentCustomDimension02),e.currentCustomDimension03?a.setItem(l.Dimension03Key,e.currentCustomDimension03):(e.currentCustomDimension03=null!=a.getItem(l.Dimension03Key)?a.getItem(l.Dimension03Key):"",e.currentCustomDimension03);var n=null!=a.getItem(l.SdkConfigCachedKey)?a.getItem(l.SdkConfigCachedKey):"";if(n){var t=JSON.parse(u.decode64(n));t&&(e.sdkConfigCached=t)}var i=l.getSdkConfig();e.configsHash=i.configs_hash?i.configs_hash:"",e.abId=i.ab_id?i.ab_id:"",e.abVariantId=i.ab_variant_id?i.ab_variant_id:"";var s=a.select(c.Progression);if(s)for(var r=0;r<s.length;++r){var o=s[r];o&&(e.progressionTries[o.progression]=o.tries)}},l.calculateServerTimeOffset=function(e){return e-u.timeIntervalSince1970()},l.validateAndCleanCustomFields=function(e){var n={};if(e){var t=0;for(var i in e){var s=e[i];if(i&&s)if(t<l.MAX_CUSTOM_FIELDS_COUNT){var r=new RegExp("^[a-zA-Z0-9_]{1,"+l.MAX_CUSTOM_FIELDS_KEY_LENGTH+"}$");if(u.stringMatch(i,r)){var o=typeof s;if("string"==o||s instanceof String)s.length<=l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH&&0<s.length?(n[i]=s,++t):d.w("validateAndCleanCustomFields: entry with key="+i+", value="+s+" has been omitted because its value is an empty string or exceeds the max number of characters ("+l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH+")");else if("number"==o||s instanceof Number){var a=s;n[i]=a,++t}else d.w("validateAndCleanCustomFields: entry with key="+i+", value="+s+" has been omitted because its value is not a string or number")}else d.w("validateAndCleanCustomFields: entry with key="+i+", value="+s+" has been omitted because its key contains illegal character, is empty or exceeds the max number of characters ("+l.MAX_CUSTOM_FIELDS_KEY_LENGTH+")")}else d.w("validateAndCleanCustomFields: entry with key="+i+", value="+s+" has been omitted because it exceeds the max number of custom fields ("+l.MAX_CUSTOM_FIELDS_COUNT+")");else d.w("validateAndCleanCustomFields: entry with key="+i+", value="+s+" has been omitted because its key or value is null")}}return n},l.validateAndFixCurrentDimensions=function(){s.validateDimension01(l.getCurrentCustomDimension01(),l.getAvailableCustomDimensions01())||l.setCustomDimension01(""),s.validateDimension02(l.getCurrentCustomDimension02(),l.getAvailableCustomDimensions02())||l.setCustomDimension02(""),s.validateDimension03(l.getCurrentCustomDimension03(),l.getAvailableCustomDimensions03())||l.setCustomDimension03("")},l.getConfigurationStringValue=function(e,n){return l.instance.configurations[e]?l.instance.configurations[e].toString():n},l.isRemoteConfigsReady=function(){return l.instance.remoteConfigsIsReady},l.addRemoteConfigsListener=function(e){l.instance.remoteConfigsListeners.indexOf(e)<0&&l.instance.remoteConfigsListeners.push(e)},l.removeRemoteConfigsListener=function(e){var n=l.instance.remoteConfigsListeners.indexOf(e);-1<n&&l.instance.remoteConfigsListeners.splice(n,1)},l.getRemoteConfigsContentAsString=function(){return JSON.stringify(l.instance.configurations)},l.populateConfigurations=function(e){var n=e.configs;if(n){l.instance.configurations={};for(var t=0;t<n.length;++t){var i=n[t];if(i){var s=i.key,r=i.value,o=i.start_ts?i.start_ts:Number.MIN_VALUE,a=i.end_ts?i.end_ts:Number.MAX_VALUE,u=l.getClientTsAdjusted();s&&r&&o<u&&u<a&&(l.instance.configurations[s]=r)}}}l.instance.remoteConfigsIsReady=!0;var d=l.instance.remoteConfigsListeners;for(t=0;t<d.length;++t)d[t]&&d[t].onRemoteConfigsUpdated()},l.CategorySdkError="sdk_error",l.MAX_CUSTOM_FIELDS_COUNT=50,l.MAX_CUSTOM_FIELDS_KEY_LENGTH=64,l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH=256,l.instance=new l,l.DefaultUserIdKey="default_user_id",l.SessionNumKey="session_num",l.TransactionNumKey="transaction_num",l.Dimension01Key="dimension01",l.Dimension02Key="dimension02",l.Dimension03Key="dimension03",l.SdkConfigCachedKey="sdk_config_cached",i=l,n.GAState=i}(gameanalytics=gameanalytics||{}),function(e){var n,o,a,t;function u(){}n=e.tasks||(e.tasks={}),o=e.utilities.GAUtilities,a=e.logging.GALogger,u.execute=function(e,n,t,i){if(u.countMap[n]||(u.countMap[n]=0),!(u.countMap[n]>=u.MaxCount)){var s=o.getHmac(i,t),r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(!r.responseText)return;if(200!=r.status)return void a.w("sdk error failed. response code not 200. status code: "+r.status+", description: "+r.statusText+", body: "+r.responseText);u.countMap[n]=u.countMap[n]+1}},r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization",s);try{r.send(t)}catch(e){console.error(e)}}},u.MaxCount=10,u.countMap={},t=u,n.SdkErrorTask=t}(gameanalytics=gameanalytics||{}),function(e){var c,l,u,f,d,g,n;function v(){this.protocol="https",this.hostName="api.gameanalytics.com",this.version="v2",this.remoteConfigsVersion="v1",this.baseUrl=this.protocol+"://"+this.hostName+"/"+this.version,this.remoteConfigsBaseUrl=this.protocol+"://"+this.hostName+"/remote_configs/"+this.remoteConfigsVersion,this.initializeUrlPath="init",this.eventsUrlPath="events",this.useGzip=!1}c=e.http||(e.http={}),l=e.state.GAState,u=e.logging.GALogger,f=e.utilities.GAUtilities,d=e.validators.GAValidator,g=e.tasks.SdkErrorTask,v.prototype.requestInit=function(e,n){var t=l.getGameKey(),i=this.remoteConfigsBaseUrl+"/"+this.initializeUrlPath+"?game_key="+t+"&interval_seconds=0&configs_hash="+e,s=l.getInitAnnotations(),r=JSON.stringify(s);if(r){var o=this.createPayloadData(r,this.useGzip),a=[];a.push(r),v.sendRequest(i,o,a,this.useGzip,v.initRequestCallback,n)}else n(c.EGAHTTPApiResponse.JsonEncodeFailed,null)},v.prototype.sendEventsInArray=function(e,n,t){if(0!=e.length){var i=l.getGameKey(),s=this.baseUrl+"/"+i+"/"+this.eventsUrlPath,r=JSON.stringify(e);if(r){var o=this.createPayloadData(r,this.useGzip),a=[];a.push(r),a.push(n),a.push(e.length.toString()),v.sendRequest(s,o,a,this.useGzip,v.sendEventInArrayRequestCallback,t)}else t(c.EGAHTTPApiResponse.JsonEncodeFailed,null,n,e.length)}},v.prototype.sendSdkErrorEvent=function(e){if(l.isEventSubmissionEnabled()){var n=l.getGameKey(),t=l.getGameSecret();if(d.validateSdkErrorEvent(n,t,e)){var i,s=this.baseUrl+"/"+n+"/"+this.eventsUrlPath,r=l.getSdkErrorEventAnnotations(),o=v.sdkErrorTypeToString(e);r.type=o;var a=[];a.push(r),(i=JSON.stringify(a))?g.execute(s,e,i,t):u.w("sendSdkErrorEvent: JSON encoding failed.")}}},v.sendEventInArrayRequestCallback=function(e,n,t,i){void 0===i&&(i=null),i[0],i[1];var s,r,o=i[2],a=parseInt(i[3]);s=e.responseText,r=e.status;var u=v.instance.processRequestResponse(r,e.statusText,s,"Events");if(u==c.EGAHTTPApiResponse.Ok||u==c.EGAHTTPApiResponse.Created||u==c.EGAHTTPApiResponse.BadRequest){var d=s?JSON.parse(s):{};null!=d?(c.EGAHTTPApiResponse.BadRequest,t(u,d,o,a)):t(c.EGAHTTPApiResponse.JsonDecodeFailed,null,o,a)}else t(u,null,o,a)},v.sendRequest=function(e,n,t,i,s,r){var o=new XMLHttpRequest,a=l.getGameSecret(),u=f.getHmac(a,n),d=[];for(var c in d.push(u),t)d.push(t[c]);if(o.onreadystatechange=function(){4===o.readyState&&s(o,e,r,d)},o.open("POST",e,!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Authorization",u),i)throw new Error("gzip not supported");try{o.send(n)}catch(e){console.error(e.stack)}},v.initRequestCallback=function(e,n,t,i){var s,r;void 0===i&&(i=null),i[0],i[1],s=e.responseText,r=e.status;var o=s?JSON.parse(s):{},a=v.instance.processRequestResponse(r,e.statusText,s,"Init");if(a==c.EGAHTTPApiResponse.Ok||a==c.EGAHTTPApiResponse.Created||a==c.EGAHTTPApiResponse.BadRequest)if(null!=o)if(a!==c.EGAHTTPApiResponse.BadRequest){var u=d.validateAndCleanInitRequestResponse(o,a===c.EGAHTTPApiResponse.Created);u?t(a,u,"",0):t(c.EGAHTTPApiResponse.BadResponse,null,"",0)}else t(a,null,"",0);else t(c.EGAHTTPApiResponse.JsonDecodeFailed,null,"",0);else t(a,null,"",0)},v.prototype.createPayloadData=function(e,n){if(n)throw new Error("gzip not supported");return e},v.prototype.processRequestResponse=function(e,n,t,i){return t?200===e?c.EGAHTTPApiResponse.Ok:201===e?c.EGAHTTPApiResponse.Created:0===e||401===e?c.EGAHTTPApiResponse.Unauthorized:400===e?c.EGAHTTPApiResponse.BadRequest:500===e?c.EGAHTTPApiResponse.InternalServerError:c.EGAHTTPApiResponse.UnknownResponseCode:c.EGAHTTPApiResponse.NoResponse},v.sdkErrorTypeToString=function(e){switch(e){case c.EGASdkErrorType.Rejected:return"rejected";default:return""}},v.instance=new v,n=v,c.GAHTTPApi=n}(gameanalytics=gameanalytics||{}),function(l){var e,f,g,v,m,p,h,d,S,y,E,n;function A(){}e=l.events||(l.events={}),f=l.store.GAStore,g=l.store.EGAStore,v=l.store.EGAStoreArgsOperator,m=l.state.GAState,p=l.logging.GALogger,h=l.utilities.GAUtilities,d=l.http.EGAHTTPApiResponse,S=l.http.GAHTTPApi,y=l.validators.GAValidator,E=l.http.EGASdkErrorType,A.addSessionStartEvent=function(){if(m.isEventSubmissionEnabled()){var e={};e.category=A.CategorySessionStart,m.incrementSessionNum(),f.setItem(m.SessionNumKey,m.getSessionNum().toString()),A.addDimensionsToEvent(e),A.addEventToStore(e),p.i("Add SESSION START event"),A.processEvents(A.CategorySessionStart,!1)}},A.addSessionEndEvent=function(){if(m.isEventSubmissionEnabled()){var e=m.getSessionStart(),n=m.getClientTsAdjusted()-e;n<0&&(p.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."),n=0);var t={};t.category=A.CategorySessionEnd,t.length=n,A.addDimensionsToEvent(t),A.addEventToStore(t),p.i("Add SESSION END event."),A.processEvents("",!1)}},A.addBusinessEvent=function(e,n,t,i,s,r){if(void 0===s&&(s=null),m.isEventSubmissionEnabled())if(y.validateBusinessEvent(e,n,s,t,i)){var o={};m.incrementTransactionNum(),f.setItem(m.TransactionNumKey,m.getTransactionNum().toString()),o.event_id=t+":"+i,o.category=A.CategoryBusiness,o.currency=e,o.amount=n,o[m.TransactionNumKey]=m.getTransactionNum(),s&&(o.cart_type=s),A.addDimensionsToEvent(o),A.addFieldsToEvent(o,m.validateAndCleanCustomFields(r)),p.i("Add BUSINESS event: {currency:"+e+", amount:"+n+", itemType:"+t+", itemId:"+i+", cartType:"+s+"}"),A.addEventToStore(o)}else S.instance.sendSdkErrorEvent(E.Rejected)},A.addResourceEvent=function(e,n,t,i,s,r){if(m.isEventSubmissionEnabled())if(y.validateResourceEvent(e,n,t,i,s,m.getAvailableResourceCurrencies(),m.getAvailableResourceItemTypes())){e===l.EGAResourceFlowType.Sink&&(t*=-1);var o={},a=A.resourceFlowTypeToString(e);o.event_id=a+":"+n+":"+i+":"+s,o.category=A.CategoryResource,o.amount=t,A.addDimensionsToEvent(o),A.addFieldsToEvent(o,m.validateAndCleanCustomFields(r)),p.i("Add RESOURCE event: {currency:"+n+", amount:"+t+", itemType:"+i+", itemId:"+s+"}"),A.addEventToStore(o)}else S.instance.sendSdkErrorEvent(E.Rejected)},A.addProgressionEvent=function(e,n,t,i,s,r,o){if(m.isEventSubmissionEnabled()){var a=A.progressionStatusToString(e);if(y.validateProgressionEvent(e,n,t,i)){var u,d={};u=t?i?n+":"+t+":"+i:n+":"+t:n,d.category=A.CategoryProgression,d.event_id=a+":"+u;var c=0;r&&e!=l.EGAProgressionStatus.Start&&(d.score=s),e===l.EGAProgressionStatus.Fail&&m.incrementProgressionTries(u),e===l.EGAProgressionStatus.Complete&&(m.incrementProgressionTries(u),c=m.getProgressionTries(u),d.attempt_num=c,m.clearProgressionTries(u)),A.addDimensionsToEvent(d),A.addFieldsToEvent(d,m.validateAndCleanCustomFields(o)),p.i("Add PROGRESSION event: {status:"+a+", progression01:"+n+", progression02:"+t+", progression03:"+i+", score:"+s+", attempt:"+c+"}"),A.addEventToStore(d)}else S.instance.sendSdkErrorEvent(E.Rejected)}},A.addDesignEvent=function(e,n,t,i){if(m.isEventSubmissionEnabled())if(y.validateDesignEvent(e,n)){var s={};s.category=A.CategoryDesign,s.event_id=e,t&&(s.value=n),A.addDimensionsToEvent(s),A.addFieldsToEvent(s,m.validateAndCleanCustomFields(i)),p.i("Add DESIGN event: {eventId:"+e+", value:"+n+"}"),A.addEventToStore(s)}else S.instance.sendSdkErrorEvent(E.Rejected)},A.addErrorEvent=function(e,n,t){if(m.isEventSubmissionEnabled()){var i=A.errorSeverityToString(e);if(y.validateErrorEvent(e,n)){var s={};s.category=A.CategoryError,s.severity=i,s.message=n,A.addDimensionsToEvent(s),A.addFieldsToEvent(s,m.validateAndCleanCustomFields(t)),p.i("Add ERROR event: {severity:"+i+", message:"+n+"}"),A.addEventToStore(s)}else S.instance.sendSdkErrorEvent(E.Rejected)}},A.processEvents=function(e,n){if(m.isEventSubmissionEnabled())try{var t=h.createGuid();n&&(A.cleanupEvents(),A.fixMissingSessionEndEvents());var i=[];i.push(["status",v.Equal,"new"]);var s=[];s.push(["status",v.Equal,"new"]),e&&(i.push(["category",v.Equal,e]),s.push(["category",v.Equal,e]));var r=[];r.push(["status",t]);var o=f.select(g.Events,i);if(!o||0==o.length)return p.i("Event queue: No events to send"),void A.updateSessionStore();if(o.length>A.MaxEventCount){if(!(o=f.select(g.Events,i,!0,A.MaxEventCount)))return;var a=o[o.length-1].client_ts;if(i.push(["client_ts",v.LessOrEqual,a]),!(o=f.select(g.Events,i)))return;s.push(["client_ts",v.LessOrEqual,a])}if(p.i("Event queue: Sending "+o.length+" events."),!f.update(g.Events,r,s))return;for(var u=[],d=0;d<o.length;++d){var c=o[d],l=JSON.parse(h.decode64(c.event));0!=l.length&&u.push(l)}S.instance.sendEventsInArray(u,t,A.processEventsCallback)}catch(e){p.e("Error during ProcessEvents(): "+e.stack)}},A.processEventsCallback=function(e,n,t,i){var s=[];if(s.push(["status",v.Equal,t]),e===d.Ok)f.delete(g.Events,s),p.i("Event queue: "+i+" events sent.");else if(e===d.NoResponse){var r=[];r.push(["status","new"]),p.w("Event queue: Failed to send events to collector - Retrying next time"),f.update(g.Events,r,s)}else{if(n){var o,a=0;for(var u in n)0==a&&(o=n[u]),++a;e===d.BadRequest&&o.constructor===Array?p.w("Event queue: "+i+" events sent. "+a+" events failed GA server validation."):p.w("Event queue: Failed to send events.")}else p.w("Event queue: Failed to send events.");f.delete(g.Events,s)}},A.cleanupEvents=function(){f.update(g.Events,[["status","new"]])},A.fixMissingSessionEndEvents=function(){if(m.isEventSubmissionEnabled()){var e=[];e.push(["session_id",v.NotEqual,m.getSessionId()]);var n=f.select(g.Sessions,e);if(n&&0!=n.length){p.i(n.length+" session(s) located with missing session_end event.");for(var t=0;t<n.length;++t){var i=JSON.parse(h.decode64(n[t].event)),s=i.client_ts-n[t].timestamp;s=Math.max(0,s),i.category=A.CategorySessionEnd,i.length=s,A.addEventToStore(i)}}}},A.addEventToStore=function(e){if(m.isEventSubmissionEnabled())if(m.isInitialized())try{if(f.isStoreTooLargeForEvents()&&!h.stringMatch(e.category,/^(user|session_end|business)$/))return void p.w("Database too large. Event has been blocked.");var n=m.getEventAnnotations(),t=h.encode64(JSON.stringify(n));for(var i in e)n[i]=e[i];var s=JSON.stringify(n);p.ii("Event added to queue: "+s);var r={status:"new"};r.category=n.category,r.session_id=n.session_id,r.client_ts=n.client_ts,r.event=h.encode64(JSON.stringify(n)),f.insert(g.Events,r),e.category==A.CategorySessionEnd?f.delete(g.Sessions,[["session_id",v.Equal,n.session_id]]):((r={}).session_id=n.session_id,r.timestamp=m.getSessionStart(),r.event=t,f.insert(g.Sessions,r,!0,"session_id")),f.isStorageAvailable()&&f.save()}catch(i){p.e("addEventToStore: error"),p.e(i.stack)}else p.w("Could not add event: SDK is not initialized")},A.updateSessionStore=function(){if(m.sessionIsStarted()){var e={};e.session_id=m.instance.sessionId,e.timestamp=m.getSessionStart(),e.event=h.encode64(JSON.stringify(m.getEventAnnotations())),f.insert(g.Sessions,e,!0,"session_id"),f.isStorageAvailable()&&f.save()}},A.addDimensionsToEvent=function(e){e&&(m.getCurrentCustomDimension01()&&(e.custom_01=m.getCurrentCustomDimension01()),m.getCurrentCustomDimension02()&&(e.custom_02=m.getCurrentCustomDimension02()),m.getCurrentCustomDimension03()&&(e.custom_03=m.getCurrentCustomDimension03()))},A.addFieldsToEvent=function(e,n){e&&n&&0<Object.keys(n).length&&(e.custom_fields=n)},A.resourceFlowTypeToString=function(e){return e==l.EGAResourceFlowType.Source||e==l.EGAResourceFlowType[l.EGAResourceFlowType.Source]?"Source":e==l.EGAResourceFlowType.Sink||e==l.EGAResourceFlowType[l.EGAResourceFlowType.Sink]?"Sink":""},A.progressionStatusToString=function(e){return e==l.EGAProgressionStatus.Start||e==l.EGAProgressionStatus[l.EGAProgressionStatus.Start]?"Start":e==l.EGAProgressionStatus.Complete||e==l.EGAProgressionStatus[l.EGAProgressionStatus.Complete]?"Complete":e==l.EGAProgressionStatus.Fail||e==l.EGAProgressionStatus[l.EGAProgressionStatus.Fail]?"Fail":""},A.errorSeverityToString=function(e){return e==l.EGAErrorSeverity.Debug||e==l.EGAErrorSeverity[l.EGAErrorSeverity.Debug]?"debug":e==l.EGAErrorSeverity.Info||e==l.EGAErrorSeverity[l.EGAErrorSeverity.Info]?"info":e==l.EGAErrorSeverity.Warning||e==l.EGAErrorSeverity[l.EGAErrorSeverity.Warning]?"warning":e==l.EGAErrorSeverity.Error||e==l.EGAErrorSeverity[l.EGAErrorSeverity.Error]?"error":e==l.EGAErrorSeverity.Critical||e==l.EGAErrorSeverity[l.EGAErrorSeverity.Critical]?"critical":""},A.instance=new A,A.CategorySessionStart="user",A.CategorySessionEnd="session_end",A.CategoryDesign="design",A.CategoryBusiness="business",A.CategoryProgression="progression",A.CategoryResource="resource",A.CategoryError="error",A.MaxEventCount=500,n=A,e.GAEvents=n}(gameanalytics=gameanalytics||{}),function(e){var s,n,t,i,r;function o(){this.blocks=new s.PriorityQueue({compare:function(e,n){return e-n}}),this.id2TimedBlockMap={},o.startThread()}s=e.threading||(e.threading={}),n=e.logging.GALogger,t=e.state.GAState,i=e.events.GAEvents,o.createTimedBlock=function(e){void 0===e&&(e=0);var n=new Date;return n.setSeconds(n.getSeconds()+e),new s.TimedBlock(n)},o.performTaskOnGAThread=function(e,n){void 0===n&&(n=0);var t=new Date;t.setSeconds(t.getSeconds()+n);var i=new s.TimedBlock(t);i.block=e,o.instance.id2TimedBlockMap[i.id]=i,o.instance.addTimedBlock(i)},o.performTimedBlockOnGAThread=function(e){o.instance.id2TimedBlockMap[e.id]=e,o.instance.addTimedBlock(e)},o.scheduleTimer=function(e,n){var t=new Date;t.setSeconds(t.getSeconds()+e);var i=new s.TimedBlock(t);return i.block=n,o.instance.id2TimedBlockMap[i.id]=i,o.instance.addTimedBlock(i),i.id},o.getTimedBlockById=function(e){return e in o.instance.id2TimedBlockMap?o.instance.id2TimedBlockMap[e]:null},o.ensureEventQueueIsRunning=function(){o.instance.keepRunning=!0,o.instance.isRunning||(o.instance.isRunning=!0,o.scheduleTimer(o.ProcessEventsIntervalInSeconds,o.processEventQueue))},o.endSessionAndStopQueue=function(){t.isInitialized()&&(n.i("Ending session."),o.stopEventQueue(),t.isEnabled()&&t.sessionIsStarted()&&(i.addSessionEndEvent(),t.instance.sessionStart=0))},o.stopEventQueue=function(){o.instance.keepRunning=!1},o.ignoreTimer=function(e){e in o.instance.id2TimedBlockMap&&(o.instance.id2TimedBlockMap[e].ignore=!0)},o.setEventProcessInterval=function(e){0<e&&(o.ProcessEventsIntervalInSeconds=e)},o.prototype.addTimedBlock=function(e){this.blocks.enqueue(e.deadline.getTime(),e)},o.run=function(){clearTimeout(o.runTimeoutId);try{for(var e;e=o.getNextBlock();)if(!e.ignore)if(e.async){if(!e.running){e.running=!0,e.block();break}}else e.block();return void(o.runTimeoutId=setTimeout(o.run,o.ThreadWaitTimeInMs))}catch(e){n.e("Error on GA thread"),n.e(e.stack)}},o.startThread=function(){o.runTimeoutId=setTimeout(o.run,0)},o.getNextBlock=function(){var e=new Date;return o.instance.blocks.hasItems()&&o.instance.blocks.peek().deadline.getTime()<=e.getTime()?o.instance.blocks.peek().async&&o.instance.blocks.peek().running?o.instance.blocks.peek():o.instance.blocks.dequeue():null},o.processEventQueue=function(){i.processEvents("",!0),o.instance.keepRunning?o.scheduleTimer(o.ProcessEventsIntervalInSeconds,o.processEventQueue):o.instance.isRunning=!1},o.instance=new o,o.ThreadWaitTimeInMs=1e3,o.ProcessEventsIntervalInSeconds=8,r=o,s.GAThreading=r}(gameanalytics=gameanalytics||{}),function(o){var a=o.threading.GAThreading,u=o.logging.GALogger,d=o.store.GAStore,c=o.state.GAState,e=o.http.GAHTTPApi,l=o.device.GADevice,i=o.validators.GAValidator,f=o.http.EGAHTTPApiResponse,g=o.utilities.GAUtilities,v=o.events.GAEvents,n=(m.init=function(){if(l.touch(),m.methodMap.configureAvailableCustomDimensions01=m.configureAvailableCustomDimensions01,m.methodMap.configureAvailableCustomDimensions02=m.configureAvailableCustomDimensions02,m.methodMap.configureAvailableCustomDimensions03=m.configureAvailableCustomDimensions03,m.methodMap.configureAvailableResourceCurrencies=m.configureAvailableResourceCurrencies,m.methodMap.configureAvailableResourceItemTypes=m.configureAvailableResourceItemTypes,m.methodMap.configureBuild=m.configureBuild,m.methodMap.configureSdkGameEngineVersion=m.configureSdkGameEngineVersion,m.methodMap.configureGameEngineVersion=m.configureGameEngineVersion,m.methodMap.configureUserId=m.configureUserId,m.methodMap.initialize=m.initialize,m.methodMap.addBusinessEvent=m.addBusinessEvent,m.methodMap.addResourceEvent=m.addResourceEvent,m.methodMap.addProgressionEvent=m.addProgressionEvent,m.methodMap.addDesignEvent=m.addDesignEvent,m.methodMap.addErrorEvent=m.addErrorEvent,m.methodMap.addErrorEvent=m.addErrorEvent,m.methodMap.setEnabledInfoLog=m.setEnabledInfoLog,m.methodMap.setEnabledVerboseLog=m.setEnabledVerboseLog,m.methodMap.setEnabledManualSessionHandling=m.setEnabledManualSessionHandling,m.methodMap.setEnabledEventSubmission=m.setEnabledEventSubmission,m.methodMap.setCustomDimension01=m.setCustomDimension01,m.methodMap.setCustomDimension02=m.setCustomDimension02,m.methodMap.setCustomDimension03=m.setCustomDimension03,m.methodMap.setEventProcessInterval=m.setEventProcessInterval,m.methodMap.startSession=m.startSession,m.methodMap.endSession=m.endSession,m.methodMap.onStop=m.onStop,m.methodMap.onResume=m.onResume,m.methodMap.addRemoteConfigsListener=m.addRemoteConfigsListener,m.methodMap.removeRemoteConfigsListener=m.removeRemoteConfigsListener,m.methodMap.getRemoteConfigsValueAsString=m.getRemoteConfigsValueAsString,m.methodMap.isRemoteConfigsReady=m.isRemoteConfigsReady,m.methodMap.getRemoteConfigsContentAsString=m.getRemoteConfigsContentAsString,"undefined"!=typeof window&&void 0!==window.GameAnalytics&&void 0!==window.GameAnalytics.q){var e=window.GameAnalytics.q;for(var n in e)m.gaCommand.apply(null,e[n])}},m.gaCommand=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];0<e.length&&e[0]in o.GameAnalytics.methodMap&&(1<e.length?o.GameAnalytics.methodMap[e[0]].apply(null,Array.prototype.slice.call(e,1)):o.GameAnalytics.methodMap[e[0]]())},m.configureAvailableCustomDimensions01=function(e){void 0===e&&(e=[]),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)?u.w("Available custom dimensions must be set before SDK is initialized"):c.setAvailableCustomDimensions01(e)})},m.configureAvailableCustomDimensions02=function(e){void 0===e&&(e=[]),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)?u.w("Available custom dimensions must be set before SDK is initialized"):c.setAvailableCustomDimensions02(e)})},m.configureAvailableCustomDimensions03=function(e){void 0===e&&(e=[]),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)?u.w("Available custom dimensions must be set before SDK is initialized"):c.setAvailableCustomDimensions03(e)})},m.configureAvailableResourceCurrencies=function(e){void 0===e&&(e=[]),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)?u.w("Available resource currencies must be set before SDK is initialized"):c.setAvailableResourceCurrencies(e)})},m.configureAvailableResourceItemTypes=function(e){void 0===e&&(e=[]),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)?u.w("Available resource item types must be set before SDK is initialized"):c.setAvailableResourceItemTypes(e)})},m.configureBuild=function(e){void 0===e&&(e=""),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)?u.w("Build version must be set before SDK is initialized."):i.validateBuild(e)?c.setBuild(e):u.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: "+e)})},m.configureSdkGameEngineVersion=function(e){void 0===e&&(e=""),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)||(i.validateSdkWrapperVersion(e)?l.sdkGameEngineVersion=e:u.i("Validation fail - configure sdk version: Sdk version not supported. String: "+e))})},m.configureGameEngineVersion=function(e){void 0===e&&(e=""),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)||(i.validateEngineVersion(e)?l.gameEngineVersion=e:u.i("Validation fail - configure game engine version: Game engine version not supported. String: "+e))})},m.configureUserId=function(e){void 0===e&&(e=""),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!1)?u.w("A custom user id must be set before SDK is initialized."):i.validateUserId(e)?c.setUserId(e):u.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: "+e)})},m.initialize=function(e,n){void 0===e&&(e=""),void 0===n&&(n=""),l.updateConnectionType();var t=a.createTimedBlock();t.async=!0,m.initTimedBlockId=t.id,t.block=function(){m.isSdkReady(!0,!1)?u.w("SDK already initialized. Can only be called once."):i.validateKeys(e,n)?(c.setKeys(e,n),m.internalInitialize()):u.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: "+e+", secretKey: "+n)},a.performTimedBlockOnGAThread(t)},m.addBusinessEvent=function(e,n,t,i,s){void 0===e&&(e=""),void 0===n&&(n=0),void 0===t&&(t=""),void 0===i&&(i=""),void 0===s&&(s=""),l.updateConnectionType(),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!0,"Could not add business event")&&v.addBusinessEvent(e,n,t,i,s,{})})},m.addResourceEvent=function(e,n,t,i,s){void 0===e&&(e=o.EGAResourceFlowType.Undefined),void 0===n&&(n=""),void 0===t&&(t=0),void 0===i&&(i=""),void 0===s&&(s=""),l.updateConnectionType(),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!0,"Could not add resource event")&&v.addResourceEvent(e,n,t,i,s,{})})},m.addProgressionEvent=function(n,t,i,s,r){void 0===n&&(n=o.EGAProgressionStatus.Undefined),void 0===t&&(t=""),void 0===i&&(i=""),void 0===s&&(s=""),l.updateConnectionType(),a.performTaskOnGAThread(function(){if(m.isSdkReady(!0,!0,"Could not add progression event")){var e="number"==typeof r;v.addProgressionEvent(n,t,i,s,e?r:0,e,{})}})},m.addDesignEvent=function(n,t){l.updateConnectionType(),a.performTaskOnGAThread(function(){if(m.isSdkReady(!0,!0,"Could not add design event")){var e="number"==typeof t;v.addDesignEvent(n,e?t:0,e,{})}})},m.addErrorEvent=function(e,n){void 0===e&&(e=o.EGAErrorSeverity.Undefined),void 0===n&&(n=""),l.updateConnectionType(),a.performTaskOnGAThread(function(){m.isSdkReady(!0,!0,"Could not add error event")&&v.addErrorEvent(e,n,{})})},m.setEnabledInfoLog=function(e){void 0===e&&(e=!1),a.performTaskOnGAThread(function(){e?(u.setInfoLog(e),u.i("Info logging enabled")):(u.i("Info logging disabled"),u.setInfoLog(e))})},m.setEnabledVerboseLog=function(e){void 0===e&&(e=!1),a.performTaskOnGAThread(function(){e?(u.setVerboseLog(e),u.i("Verbose logging enabled")):(u.i("Verbose logging disabled"),u.setVerboseLog(e))})},m.setEnabledManualSessionHandling=function(e){void 0===e&&(e=!1),a.performTaskOnGAThread(function(){c.setManualSessionHandling(e)})},m.setEnabledEventSubmission=function(e){void 0===e&&(e=!1),a.performTaskOnGAThread(function(){e?(c.setEnabledEventSubmission(e),u.i("Event submission enabled")):(u.i("Event submission disabled"),c.setEnabledEventSubmission(e))})},m.setCustomDimension01=function(e){void 0===e&&(e=""),a.performTaskOnGAThread(function(){i.validateDimension01(e,c.getAvailableCustomDimensions01())?c.setCustomDimension01(e):u.w("Could not set custom01 dimension value to '"+e+"'. Value not found in available custom01 dimension values")})},m.setCustomDimension02=function(e){void 0===e&&(e=""),a.performTaskOnGAThread(function(){i.validateDimension02(e,c.getAvailableCustomDimensions02())?c.setCustomDimension02(e):u.w("Could not set custom02 dimension value to '"+e+"'. Value not found in available custom02 dimension values")})},m.setCustomDimension03=function(e){void 0===e&&(e=""),a.performTaskOnGAThread(function(){i.validateDimension03(e,c.getAvailableCustomDimensions03())?c.setCustomDimension03(e):u.w("Could not set custom03 dimension value to '"+e+"'. Value not found in available custom03 dimension values")})},m.setEventProcessInterval=function(e){a.performTaskOnGAThread(function(){a.setEventProcessInterval(e)})},m.startSession=function(){if(c.isInitialized()){var e=a.createTimedBlock();e.async=!0,m.initTimedBlockId=e.id,e.block=function(){c.isEnabled()&&c.sessionIsStarted()&&a.endSessionAndStopQueue(),m.resumeSessionAndStartQueue()},a.performTimedBlockOnGAThread(e)}},m.endSession=function(){m.onStop()},m.onStop=function(){a.performTaskOnGAThread(function(){try{a.endSessionAndStopQueue()}catch(e){}})},m.onResume=function(){var e=a.createTimedBlock();e.async=!0,m.initTimedBlockId=e.id,e.block=function(){m.resumeSessionAndStartQueue()},a.performTimedBlockOnGAThread(e)},m.getRemoteConfigsValueAsString=function(e,n){return void 0===n&&(n=null),c.getConfigurationStringValue(e,n)},m.isRemoteConfigsReady=function(){return c.isRemoteConfigsReady()},m.addRemoteConfigsListener=function(e){c.addRemoteConfigsListener(e)},m.removeRemoteConfigsListener=function(e){c.removeRemoteConfigsListener(e)},m.getRemoteConfigsContentAsString=function(){return c.getRemoteConfigsContentAsString()},m.getABTestingId=function(){return c.getABTestingId()},m.getABTestingVariantId=function(){return c.getABTestingVariantId()},m.internalInitialize=function(){c.ensurePersistedStates(),d.setItem(c.DefaultUserIdKey,c.getDefaultId()),c.setInitialized(!0),m.newSession(),c.isEnabled()&&a.ensureEventQueueIsRunning()},m.newSession=function(){u.i("Starting a new session."),c.validateAndFixCurrentDimensions(),e.instance.requestInit(c.instance.configsHash,m.startNewSessionCallback)},m.startNewSessionCallback=function(e,n){if(e!==f.Ok&&e!==f.Created||!n)e==f.Unauthorized?(u.w("Initialize SDK failed - Unauthorized"),c.instance.initAuthorized=!1):(e===f.NoResponse||e===f.RequestTimeout?u.i("Init call (session start) failed - no response. Could be offline or timeout."):e===f.BadResponse||e===f.JsonEncodeFailed||e===f.JsonDecodeFailed?u.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers."):e!==f.BadRequest&&e!==f.UnknownResponseCode||u.i("Init call (session start) failed - bad request or unknown response."),null==c.instance.sdkConfig?null!=c.instance.sdkConfigCached?(u.i("Init call (session start) failed - using cached init values."),c.instance.sdkConfig=c.instance.sdkConfigCached):(u.i("Init call (session start) failed - using default init values."),c.instance.sdkConfig=c.instance.sdkConfigDefault):u.i("Init call (session start) failed - using cached init values."),c.instance.initAuthorized=!0);else{var t=0;if(n.server_ts){var i=n.server_ts;t=c.calculateServerTimeOffset(i)}if(n.time_offset=t,e!=f.Created){var s=c.getSdkConfig();s.configs&&(n.configs=s.configs),s.configs_hash&&(n.configs_hash=s.configs_hash),s.ab_id&&(n.ab_id=s.ab_id),s.ab_variant_id&&(n.ab_variant_id=s.ab_variant_id)}c.instance.configsHash=n.configs_hash?n.configs_hash:"",c.instance.abId=n.ab_id?n.ab_id:"",c.instance.abVariantId=n.ab_variant_id?n.ab_variant_id:"",d.setItem(c.SdkConfigCachedKey,g.encode64(JSON.stringify(n))),c.instance.sdkConfigCached=n,c.instance.sdkConfig=n,c.instance.initAuthorized=!0}if(c.instance.clientServerTimeOffset=c.getSdkConfig().time_offset?c.getSdkConfig().time_offset:0,c.populateConfigurations(c.getSdkConfig()),!c.isEnabled())return u.w("Could not start session: SDK is disabled."),void a.stopEventQueue();a.ensureEventQueueIsRunning();var r=g.createGuid();c.instance.sessionId=r,c.instance.sessionStart=c.getClientTsAdjusted(),v.addSessionStartEvent();var o=a.getTimedBlockById(m.initTimedBlockId);null!=o&&(o.running=!1),m.initTimedBlockId=-1},m.resumeSessionAndStartQueue=function(){c.isInitialized()&&(u.i("Resuming session."),c.sessionIsStarted()||m.newSession())},m.isSdkReady=function(e,n,t){return void 0===n&&(n=!0),void 0===t&&(t=""),t&&(t+=": "),e&&!c.isInitialized()?(n&&u.w(t+"SDK is not initialized"),!1):e&&!c.isEnabled()?(n&&u.w(t+"SDK is disabled"),!1):!(e&&!c.sessionIsStarted()&&(n&&u.w(t+"Session has not started yet"),1))},m.initTimedBlockId=-1,m.methodMap={},m);function m(){}o.GameAnalytics=n}(gameanalytics=gameanalytics||{}),gameanalytics.GameAnalytics.init();var GameAnalytics=gameanalytics.GameAnalytics.gaCommand;
scope.gameanalytics=gameanalytics;
scope.GameAnalytics=GameAnalytics;
})(this);
