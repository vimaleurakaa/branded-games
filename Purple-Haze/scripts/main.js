"use strict";window.g_aUJ=class{constructor(e,a){this.g_aov=e,this.g_aUK=a,this.g_aUL=!1,this.g_anA=()=>this.g_Jj()}g_aUM(){}g_aUN(e,a,_,g){this.g_aov.g_aUO(this.g_aUK,e,a,_,g)}g_aUP(e,a,_,g){return this.g_aov.g_aUQ(this.g_aUK,e,a,_,g)}g_aUR(e,a,_){this.g_aov.g_aUS()?this.g_aUN(e,a,_):this.g_aov.g_aUT()._OnMessageFromDOM({type:"event",component:this.g_aUK,handler:e,dispatchOpts:_||null,data:a,responseId:null})}g_aUU(e,a){this.g_aov.g_aUV(this.g_aUK,e,a)}g_aUW(e){for(const[a,_]of e)this.g_aUU(a,_)}g_aUX(){return this.g_aov}g_aUY(){return this.g_aUK}g_abK(){this.g_aUL||(this.g_aov.g_aUZ(this.g_anA),this.g_aUL=!0)}g_abv(){this.g_aUL&&(this.g_aov.g_aU_(this.g_anA),this.g_aUL=!1)}g_Jj(){}},"use strict",window.g_aU$=class extends g_aUJ{constructor(e,a){super(e,a),this.g_aVa=new Map,this.g_aVb=!0,this.g_aUU("create",e=>this.g_aVc(e)),this.g_aUU("destroy",e=>this.g_aVd(e)),this.g_aUU("set-visible",e=>this.g_aVe(e)),this.g_aUU("update-position",e=>this.g_aVf(e)),this.g_aUU("update-state",e=>this.g_aG$(e)),this.g_aUU("focus",e=>this.g_aVg(e)),this.g_aUU("set-css-style",e=>this.g_aVh(e))}g_aVi(e){this.g_aVb=!!e}g_aVj(e,_){this.g_aUU(e,e=>{const a=e.elementId,g=this.g_aVa.get(a);return _(g,e)})}g_aVc(e){const a=e.elementId,_=this.g_aci(a,e);this.g_aVa.set(a,_),e.isVisible||(_.style.display="none"),this.g_aVb&&document.body.appendChild(_)}g_aci(){throw new Error("required override")}g_aVk(){}g_aVd(e){const a=e.elementId,_=this.g_aVa.get(a);this.g_aVk(_),this.g_aVb&&_.parentElement.removeChild(_),this.g_aVa.delete(a)}g_aVl(e,a,_){_||(_={}),_.elementId=a,this.g_aUN(e,_)}g_aVm(e,a,_){_||(_={}),_.elementId=a,this.g_aUR(e,_)}g_aVe(e){if(this.g_aVb){const a=this.g_aVa.get(e.elementId);a.style.display=e.isVisible?"":"none"}}g_aVf(e){if(this.g_aVb){const a=this.g_aVa.get(e.elementId);a.style.left=e.left+"px",a.style.top=e.top+"px",a.style.width=e.width+"px",a.style.height=e.height+"px";const _=e.fontSize;null!==_&&(a.style.fontSize=_+"em")}}g_aG$(e){const a=this.g_aVa.get(e.elementId);this.g_aVn(a,e)}g_aVn(){throw new Error("required override")}g_aVg(e){const a=this.g_aVa.get(e.elementId);e.focus?a.focus():a.blur()}g_aVh(e){const a=this.g_aVa.get(e.elementId);a.style[e.prop]=e.val}g_aVo(e){return this.g_aVa.get(e)}},"use strict";{function _(e){return new Promise((a,_)=>{const g=document.createElement("script");g.onload=a,g.onerror=_,g.async=!1,g.src=e,document.head.appendChild(g)})}async function t(e){const a=await n(e),_=new TextDecoder("utf-8");return _.decode(a)}function n(e){return new Promise((_,g)=>{const a=new FileReader;a.onload=e=>_(e.target.result),a.onerror=e=>g(e),a.readAsArrayBuffer(e)})}const a=/(iphone|ipod|ipad)/i.test(navigator.userAgent);let o=new Audio;const r={"audio/webm; codecs=opus":!!o.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!o.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!o.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!o.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!o.canPlayType("audio/mp4"),"audio/mpeg":!!o.canPlayType("audio/mpeg")};o=null;const e=[];let g=0;window.RealFile=window.File;const s=[],i=new Map,u=new Map;let p=0;const l=[];self.g_aVp=function(e){if("function"!=typeof e)throw new Error("runOnStartup called without a function");l.push(e)},window.g_aVq=class o{constructor(e){this.g_aVr=e.g_aVs,this.g_aVt=null,this.g_amz="",this.g_aVu=e.g_aVv,this.g_aVw={},this.g_aVx=null,this.g_aVy=null,this.g_aVz=[],this.g_aVA=null,this.g_akA=null,this.g_aop=null,this.g_alh=-1,this.g_aVB=()=>this.g_aVC(),this.g_aVD=[],this.g_amE=e.g_aVE,("cordova"===this.g_amE||"playable-ad"===this.g_amE||"instant-games"===this.g_amE)&&this.g_aVr&&(console.warn("[C3 runtime] Worker mode is enabled and supported, but is disabled in WebViews due to crbug.com/923007. Reverting to DOM mode."),this.g_aVr=!1),/CrOS/.test(navigator.userAgent)&&(console.warn("[C3 runtime] Worker mode is enabled and supported, but is disabled in Chrome OS due to reports of crashes. Reverting to DOM mode."),this.g_aVr=!1),this.g_aVF=!1,this.g_aVG=null,("html5"===this.g_amE||"playable-ad"===this.g_amE)&&"file"===location.protocol.substr(0,4)&&alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)"),this.g_aUV("runtime","cordova-fetch-local-file",e=>this.g_aVH(e)),this.g_aUV("runtime","create-job-worker",e=>this.g_aVI(e)),"cordova"===this.g_amE?document.addEventListener("deviceready",()=>this.g_aay(e)):this.g_aay(e)}g_em(){this.g_aVJ(),this.g_aVt&&(this.g_aVt.onmessage=null,this.g_aVt=null),this.g_aVx&&(this.g_aVx.terminate(),this.g_aVx=null),this.g_aVy&&(this.g_aVy.g_em(),this.g_aVy=null),this.g_akA&&(this.g_akA.parentElement.removeChild(this.g_akA),this.g_akA=null)}g_aVK(){return this.g_akA}g_fg(){return this.g_amz}g_aUS(){return this.g_aVr}g_apV(){return this.g_amE}g_aoN(){return"cordova"===this.g_amE&&a}g_aVL(){return"cordova"===this.g_amE&&!1===a}async g_aay(e){if("playable-ad"===this.g_amE){this.g_aVG=self.c3_base64files,await this.g_aVM();for(let a=0,_=e.g_aVN.length;a<_;++a){const _=e.g_aVN[a].toLowerCase();this.g_aVG.hasOwnProperty(_)&&(e.g_aVN[a]=URL.createObjectURL(this.g_aVG[_]))}}if(e.g_aVO)this.g_amz=e.g_aVO;else{const e=location.origin;this.g_amz=("null"===e?"file:///":e)+location.pathname;const a=this.g_amz.lastIndexOf("/");-1!==a&&(this.g_amz=this.g_amz.substr(0,a+1))}if(e.g_aVP)for(const[a,_]of Object.entries(e.g_aVP))this.g_aVw[a]=URL.createObjectURL(_);const a=new MessageChannel;this.g_aVt=a.port1,this.g_aVt.onmessage=e=>this._OnMessageFromRuntime(e.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(e=>this.g_aVQ(e)),this.g_aop=new self.g_aVR(this),await this.g_aop.g_ahH(),this.g_aVS(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode(),await this.g_aVT(),this.g_aVr?await this.g_aVU(e,a.port2):await this.g_aVV(e,a.port2)}g_aVW(e){return this.g_aVw.hasOwnProperty(e)?this.g_aVw[e]:e.endsWith("/workermain.js")&&this.g_aVw.hasOwnProperty("workermain.js")?this.g_aVw["workermain.js"]:"playable-ad"===this.g_amE&&this.g_aVG.hasOwnProperty(e.toLowerCase())?URL.createObjectURL(this.g_aVG[e.toLowerCase()]):e}async g_aVX(_,a,g){if(_.startsWith("blob:"))return new Worker(_,g);if(this.g_aoN()){const a=await this.g_As(this.g_aVu+_),e=new Blob([a],{type:"application/javascript"});return new Worker(URL.createObjectURL(e),g)}const t=new URL(_,a),n=location.origin!==t.origin;if(n){const e=await fetch(t);if(!e.ok)throw new Error("failed to fetch worker script");const a=await e.blob();return new Worker(URL.createObjectURL(a),g)}return new Worker(t,g)}g_aVS(){if(this.g_aoN()){const _=document.documentElement.style,a=document.body.style,g=window.innerWidth<window.innerHeight,t=g?window.screen.width:window.screen.height,n=g?window.screen.height:window.screen.width;a.height=_.height=n+"px",a.width=_.width=t+"px"}}g_aVY(e){return{baseUrl:this.g_amz,windowInnerWidth:window.innerWidth,windowInnerHeight:window.innerHeight,devicePixelRatio:window.devicePixelRatio,isFullscreen:o.g_alL(),projectData:e.g_aVZ,previewImageBlobs:window.cr_previewImageBlobs||this.g_aVG,previewProjectFileBlobs:window.cr_previewProjectFileBlobs,exportType:e.g_aVE,isDebug:-1<self.location.search.indexOf("debug"),ife:!!self.g_aV_,jobScheduler:this.g_aop.g_aV$(),supportedAudioFormats:r,opusWasmScriptUrl:window.cr_opusWasmScriptUrl||this.g_aVu+"opus.wasm.js",opusWasmBinaryUrl:window.cr_opusWasmBinaryUrl||this.g_aVu+"opus.wasm.wasm",isWKWebView:this.g_aoN(),isFBInstantAvailable:"undefined"!=typeof self.FBInstant}}async g_aVU(e,a){const _=this.g_aVW(e.g_aWa);this.g_aVx=await this.g_aVX(_,this.g_amz,{name:"Runtime"}),this.g_akA=document.createElement("canvas"),this.g_akA.style.display="none";const g=this.g_akA.transferControlToOffscreen();document.body.appendChild(this.g_akA),window.c3canvas=this.g_akA,this.g_aVx.postMessage(Object.assign(this.g_aVY(e),{type:"init-runtime",isInWorker:!0,messagePort:a,canvas:g,workerDependencyScripts:e.g_aWb||[],engineScripts:e.g_aVN,projectScripts:window.g_aWc,projectScriptsStatus:self.C3_ProjectScriptsStatus}),[a,g,...this.g_aop.g_aWd()]),this.g_aVz=s.map(e=>new e(this)),this.g_aWe(),self.c3_callFunction=(e,a)=>this.g_aVA.g_S$(e,a),"preview"===this.g_amE&&(self.goToLastErrorScript=()=>this.g_aUO("runtime","go-to-last-error-script"))}async g_aVV(a,g){this.g_akA=document.createElement("canvas"),this.g_akA.style.display="none",document.body.appendChild(this.g_akA),window.c3canvas=this.g_akA,this.g_aVz=s.map(e=>new e(this)),this.g_aWe();const t=a.g_aVN.map(e=>new URL(e,this.g_amz).toString());if(Array.isArray(a.g_aWb)&&t.unshift(...a.g_aWb),await Promise.all(t.map(a=>_(a))),a.g_aWf&&0<a.g_aWf.length){const e=self.C3_ProjectScriptsStatus;try{if(await Promise.all(a.g_aWf.map(a=>_(a[1]))),Object.values(e).some(e=>!e))return void self.setTimeout(()=>this.g_aWg(e),100)}catch(_){return console.error("[Preview] Error loading project scripts: ",_),void self.setTimeout(()=>this.g_aWg(e),100)}}if("preview"===this.g_amE&&"object"!=typeof self.g_aQ.g_aUI)return console.error("[C3 runtime] Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax."),void alert("Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax.");const n=Object.assign(this.g_aVY(a),{isInWorker:!1,messagePort:g,canvas:this.g_akA,runOnStartupFunctions:l});this.g_aVy=self.C3_CreateRuntime(n),await self.C3_InitRuntime(this.g_aVy,n)}g_aWg(e){const a=Object.entries(e).filter(e=>!e[1]).map(e=>e[0]),_=`Failed to load project script '${a[0]}'. Check all your JavaScript code has valid syntax.`;console.error("[Preview] "+_),alert(_)}async g_aVI(){const e=await this.g_aop.g_aWh();return{outputPort:e,transferables:[e]}}g_aUT(){if(this.g_aVr)throw new Error("not available in worker mode");return this.g_aVy}g_aUO(_,a,g,t,n){this.g_aVt.postMessage({type:"event",component:_,handler:a,dispatchOpts:t||null,data:g,responseId:null},this.g_aVF?void 0:n)}g_aUQ(_,a,t,n,i){const e=p++,o=new Promise((_,a)=>{u.set(e,{resolve:_,reject:a})});return this.g_aVt.postMessage({type:"event",component:_,handler:a,dispatchOpts:n||null,data:t,responseId:e},this.g_aVF?void 0:i),o}["_OnMessageFromRuntime"](e){const a=e.type;if("event"===a)this.g_aWi(e);else if("result"===a)this.g_aWj(e);else if("runtime-ready"===a)this.g_aWk();else if("alert"===a)alert(e.message);else throw new Error(`unknown message '${a}'`)}g_aWi(_){const t=_.component,n=_.handler,a=_.data,o=_.responseId,e=i.get(t);if(!e)return void console.warn(`[DOM] No event handlers for component '${t}'`);const r=e.get(n);if(!r)return void console.warn(`[DOM] No handler '${n}' for component '${t}'`);let g=null;try{g=r(a)}catch(e){return console.error(`Exception in '${t}' handler '${n}':`,e),void(null!==o&&this.g_aWl(o,!1,e.toString()))}null!==o&&(g&&g.then?g.then(e=>this.g_aWl(o,!0,e)).catch(e=>{console.error(`Rejection from '${t}' handler '${n}':`,e),this.g_aWl(o,!1,e.toString())}):this.g_aWl(o,!0,g))}g_aWl(e,a,_){let g;_&&_.transferables&&(g=_.transferables),this.g_aVt.postMessage({type:"result",responseId:e,isOk:a,result:_},g)}g_aWj(_){const a=_.responseId,g=_.isOk,t=_.result,n=u.get(a);g?n.resolve(t):n.reject(t),u.delete(a)}g_aUV(e,a,_){let g=i.get(e);if(g||(g=new Map,i.set(e,g)),g.has(a))throw new Error(`[DOM] Component '${e}' already has handler '${a}'`);g.set(a,_)}static g_aWm(e){if(s.includes(e))throw new Error("DOM handler already added");s.push(e)}g_aWe(){for(const e of this.g_aVz)if("runtime"===e.g_aUY())return void(this.g_aVA=e);throw new Error("cannot find runtime DOM handler")}g_aVQ(e){this.g_aUO("debugger","message",e)}g_aWk(){for(const e of this.g_aVz)e.g_aUM()}static g_alL(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}async g_aWn(){return await this.g_aUQ("runtime","get-remote-preview-status-info")}g_aUZ(e){this.g_aVD.push(e),this.g_aWo()}g_aU_(e){const a=this.g_aVD.indexOf(e);if(-1===a)throw new Error("invalid callback");this.g_aVD.splice(a,1),this.g_aVD.length||this.g_aVJ()}g_aWo(){-1===this.g_alh&&this.g_aVD.length&&(this.g_alh=requestAnimationFrame(this.g_aVB))}g_aVJ(){-1!==this.g_alh&&(cancelAnimationFrame(this.g_alh),this.g_alh=-1)}g_aVC(){this.g_alh=-1;for(const e of this.g_aVD)e();this.g_aWo()}g_aWp(e){this.g_aVA.g_aWp(e)}g_aWq(e){this.g_aVA.g_aWq(e)}g_aWr(){this.g_aVA.g_aWr()}g_aHK(e){this.g_aVA.g_aHK(e)}g_AP(e){return!!r[e]}async g_adC(e){const a=await this.g_aUQ("runtime","opus-decode",{arrayBuffer:e},null,[e]);return new Float32Array(a)}g_fS(e){return /^(?:[a-z]+:)?\/\//.test(e)||"data:"===e.substr(0,5)||"blob:"===e.substr(0,5)}g_fT(e){return!this.g_fS(e)}async g_aVH(e){const a=e.filename;switch(e.as){case"text":return await this.g_At(a);case"buffer":return await this.g_As(a);default:throw new Error("unsupported type");}}g_aWs(e){const _=window.cordova.file.applicationDirectory+"www/"+e.toLowerCase();return new Promise((e,a)=>{window.resolveLocalFileSystemURL(_,_=>{_.file(e,a)},a)})}async g_At(e){const a=await this.g_aWs(e);return await t(a)}g_aWt(){if(e.length&&!(8<=g)){g++;const _=e.shift();this.g_aWu(_.filename,_.g_aWv,_.g_aWw)}}g_As(_){return new Promise((t,n)=>{e.push({filename:_,g_aWv:e=>{g--,this.g_aWt(),t(e)},g_aWw:e=>{g--,this.g_aWt(),n(e)}}),this.g_aWt()})}async g_aWu(_,a,e){try{const g=await this.g_aWs(_),t=await n(g);a(t)}catch(_){e(_)}}async g_aVM(){const e=[];for(const[a,_]of Object.entries(this.g_aVG))e.push(this.g_aWx(a,_));await Promise.all(e)}async g_aWx(e,a){if("object"==typeof a)this.g_aVG[e]=new Blob([a.str],{type:a.type});else{const _=await fetch(a),g=await _.blob();this.g_aVG[e]=g}}g_aVT(){let e=null;const _=new Promise(a=>e=a),g=new ArrayBuffer(1),t=new MessageChannel;return t.port2.onmessage=a=>{a.data&&a.data.arrayBuffer||(this.g_aVF=!0,console.warn("MessageChannel transfers determined to be broken. Disabling transferables.")),e()},t.port1.postMessage({arrayBuffer:g},[g]),_}}}{function _(e){return e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents||e.originalEvent&&e.originalEvent.sourceCapabilities&&e.originalEvent.sourceCapabilities.firesTouchEvents}function t(e){return new Promise((a,_)=>{const g=document.createElement("link");g.onload=()=>a(g),g.onerror=e=>_(e),g.rel="stylesheet",g.href=e,document.head.appendChild(g)})}function a(e){return new Promise((a,_)=>{const g=new Image;g.onload=()=>a(g),g.onerror=e=>_(e),g.src=e})}async function r(e){const _=URL.createObjectURL(e);try{return await a(_)}finally{URL.revokeObjectURL(_)}}function s(e){do{if(e.parentNode&&e.hasAttribute("contenteditable"))return!0;e=e.parentNode}while(e);return!1}function d(e){const a=e.target.tagName.toLowerCase();l.has(a)&&e.preventDefault()}function e(e){(e.metaKey||e.ctrlKey)&&e.preventDefault()}function g(){try{return window.parent&&window.parent.document.hasFocus()}catch(e){return!1}}const u=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),i={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},p={dispatchUserScriptEvent:!0},c={dispatchRuntimeEvent:!0},l=new Set(["canvas","body","html"]);self.C3_RasterSvgImage=async function(_,a,g){const t=document.createElement("canvas");t.width=a,t.height=g;const n=t.getContext("2d");return n.drawImage(_,0,0,a,g),t};let m=!1;document.addEventListener("pause",()=>m=!0),document.addEventListener("resume",()=>m=!1);const n=class extends g_aUJ{constructor(_){super(_,"runtime"),this.g_aWy=!0,this.g_aWz=-1,this.g_aWA="any",this.g_aWB=!1,this.g_aWC=!1,this.g_aWD=null,_.g_aUV("canvas","update-size",e=>this.g_aWE(e)),_.g_aUV("runtime","invoke-download",e=>this.g_aWF(e)),_.g_aUV("runtime","raster-svg-image",e=>this.g_aWG(e)),_.g_aUV("runtime","set-target-orientation",e=>this.g_aWH(e)),_.g_aUV("runtime","register-sw",()=>this.g_aWI()),_.g_aUV("runtime","post-to-debugger",e=>this.g_aWJ(e)),_.g_aUV("runtime","go-to-script",e=>this.g_aWJ(e)),_.g_aUV("runtime","before-start-ticking",()=>this.g_aWK()),_.g_aUV("runtime","debug-highlight",e=>this.g_aWL(e)),_.g_aUV("runtime","enable-device-orientation",()=>this.g_aWM()),_.g_aUV("runtime","enable-device-motion",()=>this.g_aWN()),_.g_aUV("runtime","add-stylesheet",e=>this.g_aWO(e));const g=new Set(["input","textarea","datalist"]);window.addEventListener("contextmenu",e=>{const a=e.target,_=a.tagName.toLowerCase();g.has(_)||s(a)||e.preventDefault()}),window.addEventListener("selectstart",d),window.addEventListener("gesturehold",d),window.addEventListener("touchstart",d,{passive:!1});const a=_.g_aVK();"undefined"==typeof PointerEvent?a.addEventListener("touchstart",d):(window.addEventListener("pointerdown",d,{passive:!1}),a.addEventListener("pointerdown",d)),this.g_aWP=0,window.addEventListener("mousedown",e=>{1===e.button&&e.preventDefault()}),window.addEventListener("mousewheel",e,{passive:!1}),window.addEventListener("wheel",e,{passive:!1}),window.addEventListener("resize",()=>this.g_aly()),this.g_aWQ=new Set,this.g_aWR=new WeakSet,this.g_aGT=!1}g_aWK(){return"cordova"===this.g_aov.g_apV()?(document.addEventListener("pause",()=>this.g_aor(!0)),document.addEventListener("resume",()=>this.g_aor(!1))):document.addEventListener("visibilitychange",()=>this.g_aor(document.hidden)),{isSuspended:!!(document.hidden||m)}}g_aUM(){window.addEventListener("focus",()=>this.g_aWS("window-focus")),window.addEventListener("blur",()=>{this.g_aWS("window-blur",{parentHasFocus:g()}),this.g_aWP=0}),window.addEventListener("fullscreenchange",()=>this.g_alz()),window.addEventListener("webkitfullscreenchange",()=>this.g_alz()),window.addEventListener("mozfullscreenchange",()=>this.g_alz()),window.addEventListener("fullscreenerror",e=>this.g_alA(e)),window.addEventListener("webkitfullscreenerror",e=>this.g_alA(e)),window.addEventListener("mozfullscreenerror",e=>this.g_alA(e)),window.addEventListener("keydown",e=>this.g_aWT("keydown",e)),window.addEventListener("keyup",e=>this.g_aWT("keyup",e)),window.addEventListener("dblclick",e=>this.g_aWU("dblclick",e,i)),window.addEventListener("wheel",e=>this.g_aWV("wheel",e)),"undefined"==typeof PointerEvent?(window.addEventListener("mousedown",e=>this.g_aWW("pointerdown",e)),window.addEventListener("mousemove",e=>this.g_aWW("pointermove",e)),window.addEventListener("mouseup",e=>this.g_aWW("pointerup",e)),window.addEventListener("touchstart",e=>this.g_aWX("pointerdown",e)),window.addEventListener("touchmove",e=>this.g_aWX("pointermove",e)),window.addEventListener("touchend",e=>this.g_aWX("pointerup",e)),window.addEventListener("touchcancel",e=>this.g_aWX("pointercancel",e))):(window.addEventListener("pointerdown",e=>this.g_aWY("pointerdown",e)),window.addEventListener("pointermove",e=>this.g_aWY("pointermove",e)),window.addEventListener("pointerup",e=>this.g_aWY("pointerup",e)),window.addEventListener("pointercancel",e=>this.g_aWY("pointercancel",e)));const e=()=>this.g_aWr();window.addEventListener("pointerup",e,!0),window.addEventListener("touchend",e,!0),window.addEventListener("click",e,!0),window.addEventListener("keydown",e,!0),window.addEventListener("gamepadconnected",e,!0)}g_aWS(e,a){this.g_aUN(e,a||null,c)}g_aWZ(){return Math.max(window.innerWidth,1)}g_aW_(){return Math.max(window.innerHeight,1)}g_aly(){const e=this.g_aWZ(),a=this.g_aW_();this.g_aWS("window-resize",{innerWidth:e,innerHeight:a,devicePixelRatio:window.devicePixelRatio}),this.g_aov.g_aoN()&&(-1!==this.g_aWz&&clearTimeout(this.g_aWz),this.g_aW$(e,a,0))}g_aXa(e,a,_){-1!==this.g_aWz&&clearTimeout(this.g_aWz),this.g_aWz=setTimeout(()=>this.g_aW$(e,a,_),48)}g_aW$(_,a,g){const t=this.g_aWZ(),n=this.g_aW_();this.g_aWz=-1,t!=_||n!=a?this.g_aWS("window-resize",{innerWidth:t,innerHeight:n,devicePixelRatio:window.devicePixelRatio}):10>g&&this.g_aXa(t,n,g+1)}g_aWH(e){this.g_aWA=e.targetOrientation}g_aXb(){const e=this.g_aWA;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(e).catch(e=>console.warn("[Construct 3] Failed to lock orientation: ",e));else try{let a=!1;screen.lockOrientation?a=screen.lockOrientation(e):screen.webkitLockOrientation?a=screen.webkitLockOrientation(e):screen.mozLockOrientation?a=screen.mozLockOrientation(e):screen.msLockOrientation&&(a=screen.msLockOrientation(e)),a||console.warn("[Construct 3] Failed to lock orientation")}catch(e){console.warn("[Construct 3] Failed to lock orientation: ",e)}}g_alz(){const e=g_aVq.g_alL();e&&"any"!==this.g_aWA&&this.g_aXb(),this.g_aUN("fullscreenchange",{isFullscreen:e,innerWidth:this.g_aWZ(),innerHeight:this.g_aW_()})}g_alA(e){console.warn("[Construct 3] Fullscreen request failed: ",e),this.g_aUN("fullscreenerror",{isFullscreen:g_aVq.g_alL(),innerWidth:this.g_aWZ(),innerHeight:this.g_aW_()})}g_aor(e){e?this.g_aov.g_aVJ():this.g_aov.g_aWo(),this.g_aUN("visibilitychange",{hidden:e})}g_aWT(e,a){const _=u.get(a.code)||a.code;this.g_aUR(e,{code:_,key:a.key,which:a.which,repeat:a.repeat,altKey:a.altKey,ctrlKey:a.ctrlKey,metaKey:a.metaKey,shiftKey:a.shiftKey,timeStamp:a.timeStamp},i)}g_aWV(e,a){this.g_aUN(e,{clientX:a.clientX,clientY:a.clientY,deltaX:a.deltaX,deltaY:a.deltaY,deltaZ:a.deltaZ,deltaMode:a.deltaMode,timeStamp:a.timeStamp},i)}g_aWU(a,e,g){_(e)||("mousedown"===a&&window!==window.top&&window.focus(),this.g_aUR(a,{button:e.button,buttons:e.buttons,clientX:e.clientX,clientY:e.clientY,timeStamp:e.timeStamp},g))}g_aWW(a,e){if(!_(e)){"pointerdown"===a&&window!==window.top&&window.focus();const _=this.g_aWP;"pointerdown"===a&&0!==_?a="pointermove":"pointerup"==a&&0!==e.buttons&&(a="pointermove"),this.g_aUR(a,{pointerId:1,pointerType:"mouse",button:e.button,buttons:e.buttons,lastButtons:_,clientX:e.clientX,clientY:e.clientY,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,timeStamp:e.timeStamp},i),this.g_aWP=e.buttons,this.g_aWU(e.type,e,p)}}g_aWY(e,a){"pointerdown"===e&&window!==window.top&&window.focus();let _=0;if("mouse"===a.pointerType&&(_=this.g_aWP),this.g_aUR(e,{pointerId:a.pointerId,pointerType:a.pointerType,button:a.button,buttons:a.buttons,lastButtons:_,clientX:a.clientX,clientY:a.clientY,width:a.width||0,height:a.height||0,pressure:a.pressure||0,tangentialPressure:a.tangentialPressure||0,tiltX:a.tiltX||0,tiltY:a.tiltY||0,twist:a.twist||0,timeStamp:a.timeStamp},i),"mouse"===a.pointerType){let _="mousemove";"pointerdown"===e?_="mousedown":"pointerup"==e&&(_="pointerup"),this.g_aWU(_,a,p),this.g_aWP=a.buttons}}g_aWX(e,a){"pointerdown"===e&&window!==window.top&&window.focus();for(let _=0,g=a.changedTouches.length;_<g;++_){const g=a.changedTouches[_];this.g_aUR(e,{pointerId:g.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:g.clientX,clientY:g.clientY,width:2*(g.radiusX||g.webkitRadiusX||0),height:2*(g.radiusY||g.webkitRadiusY||0),pressure:g.force||g.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:g.rotationAngle||0,timeStamp:a.timeStamp},i)}}g_aWM(){this.g_aWB||(this.g_aWB=!0,window.addEventListener("deviceorientation",e=>this.g_awv(e)))}g_aWN(){this.g_aWC||(this.g_aWC=!0,window.addEventListener("devicemotion",e=>this.g_aww(e)))}g_awv(e){this.g_aUN("deviceorientation",{alpha:e.alpha||0,beta:e.beta||0,gamma:e.gamma||0,timeStamp:e.timeStamp},i)}g_aww(_){let a=null;const t=_.acceleration;t&&(a={x:t.x||0,y:t.y||0,z:t.z||0});let n=null;const o=_.accelerationIncludingGravity;o&&(n={x:o.x||0,y:o.y||0,z:o.z||0});let e=null;const r=_.rotationRate;r&&(e={alpha:r.alpha||0,beta:r.beta||0,gamma:r.gamma||0}),this.g_aUN("devicemotion",{acceleration:a,accelerationIncludingGravity:n,rotationRate:e,interval:_.interval,timeStamp:_.timeStamp},i)}g_aWE(e){const a=this.g_aUX(),_=a.g_aVK();_.style.width=e.styleWidth+"px",_.style.height=e.styleHeight+"px",_.style.marginLeft=e.marginLeft+"px",_.style.marginTop=e.marginTop+"px",a.g_aVS(),this.g_aWy&&(_.style.display="",this.g_aWy=!1)}g_aWF(_){const g=_.url,t=_.filename,n=document.createElement("a"),e=document.body;n.textContent=t,n.href=g,n.download=t,e.appendChild(n),n.click(),e.removeChild(n)}async g_aWG(_){const a=_.blob,t=_.width,n=_.height,e=await r(a),i=await self.C3_RasterSvgImage(e,t,n);return await createImageBitmap(i)}async g_aWO(e){await t(e.url)}g_aWr(){const e=[...this.g_aWQ];if(this.g_aWQ.clear(),!this.g_aGT)for(const _ of e){const e=_.play();e&&e.catch(()=>{this.g_aWR.has(_)||this.g_aWQ.add(_)})}}g_aWp(e){if("function"!=typeof e.play)throw new Error("missing play function");this.g_aWR.delete(e);let a;try{a=e.play()}catch(a){return void this.g_aWQ.add(e)}a&&a.catch(()=>{this.g_aWR.has(e)||this.g_aWQ.add(e)})}g_aWq(e){this.g_aWQ.delete(e),this.g_aWR.add(e)}g_aHK(e){this.g_aGT=!!e}g_aWL(e){const a=e.show;if(!a)return void(this.g_aWD&&(this.g_aWD.style.display="none"));this.g_aWD||(this.g_aWD=document.createElement("div"),this.g_aWD.id="inspectOutline",document.body.appendChild(this.g_aWD));const _=this.g_aWD;_.style.display="",_.style.left=e.left-1+"px",_.style.top=e.top-1+"px",_.style.width=e.width+2+"px",_.style.height=e.height+2+"px",_.textContent=e.name}g_aWI(){window.C3_RegisterSW&&window.C3_RegisterSW()}g_aWJ(e){window.c3_postToMessagePort&&(e.from="runtime",window.c3_postToMessagePort(e))}g_S$(e,a){return this.g_aUP("js-invoke-function",{name:e,params:a})}};g_aVq.g_aWm(n)}{const e=document.currentScript.src;self.g_aVR=class{constructor(a){this.g_aXc=a,this.g_amz=e?e.substr(0,e.lastIndexOf("/")+1):a.g_fg(),this.g_aqA=Math.min(navigator.hardwareConcurrency||2,16),this.g_aXd=null,this.g_aXe=[],this.g_aqy=null,this.g_aXf=null}async g_ahH(){if(this.g_aXg)throw new Error("already initialised");this.g_aXg=!0;const e=this.g_aXc.g_aVW("dispatchworker.js");this.g_aXd=await this.g_aXc.g_aVX(e,this.g_amz,{name:"DispatchWorker"});const a=new MessageChannel;this.g_aqy=a.port1,this.g_aXd.postMessage({type:"_init","in-port":a.port2},[a.port2]),this.g_aXf=await this.g_aWh()}async g_aWh(){const _=this.g_aXe.length,a=this.g_aXc.g_aVW("jobworker.js"),g=await this.g_aXc.g_aVX(a,this.g_amz,{name:"JobWorker"+_}),t=new MessageChannel,n=new MessageChannel;return this.g_aXd.postMessage({type:"_addJobWorker",port:t.port1},[t.port1]),g.postMessage({type:"init",number:_,"dispatch-port":t.port2,"output-port":n.port2},[t.port2,n.port2]),this.g_aXe.push(g),n.port1}g_aV$(){return{inputPort:this.g_aqy,outputPort:this.g_aXf,maxNumWorkers:this.g_aqA}}g_aWd(){return[this.g_aqy,this.g_aXf]}}}if("use strict",window.C3_IsSupported){"undefined"!=typeof OffscreenCanvas;window.c3_runtimeInterface=new g_aVq({g_aVs:!1,g_aWa:"workermain.js",g_aVN:["scripts/c3runtime.js"],g_aVv:"scripts/",g_aWb:[],g_aVE:"html5"})}{const e=class extends g_aUJ{constructor(e){super(e,"touch"),this.g_aUU("request-permission",e=>this.g_aXh(e))}async g_aXh(e){const a=e.type;let _=!0;0===a?_=await this.g_aXi():1===a&&(_=await this.g_aXj()),this.g_aUN("permission-result",{type:a,result:_})}async g_aXi(){if(!self.DeviceOrientationEvent||!self.DeviceOrientationEvent.requestPermission)return!0;try{const e=await self.DeviceOrientationEvent.requestPermission();return"granted"===e}catch(e){return console.warn("[Touch] Failed to request orientation permission: ",e),!1}}async g_aXj(){if(!self.DeviceMotionEvent||!self.DeviceMotionEvent.requestPermission)return!0;try{const e=await self.DeviceMotionEvent.requestPermission();return"granted"===e}catch(e){return console.warn("[Touch] Failed to request motion permission: ",e),!1}}};g_aVq.g_aWm(e)}{function _(e){e.stopPropagation()}function a(e){13!==e.which&&27!==e.which&&e.stopPropagation()}const e=class extends g_aU${constructor(e){super(e,"text-input"),this.g_aVj("scroll-to-bottom",e=>this.g_aXk(e))}g_aci(g,t){let n;const i=t.type;return"textarea"===i?(n=document.createElement("textarea"),n.style.resize="none"):(n=document.createElement("input"),n.type=i),n.style.position="absolute",n.autocomplete="off",n.addEventListener("touchstart",_),n.addEventListener("touchmove",_),n.addEventListener("touchend",_),n.addEventListener("mousedown",_),n.addEventListener("mouseup",_),n.addEventListener("keydown",a),n.addEventListener("keyup",a),n.addEventListener("click",e=>{e.stopPropagation(),this.g_aVm("click",g)}),n.addEventListener("dblclick",e=>{e.stopPropagation(),this.g_aVm("dblclick",g)}),n.addEventListener("input",()=>this.g_aVl("change",g,{text:n.value})),n.id=t.id,this.g_aVn(n,t),n}g_aVn(e,a){e.value=a.text,e.placeholder=a.placeholder,e.title=a.title,e.disabled=!a.isEnabled,e.readOnly=a.isReadOnly,e.spellcheck=a.spellCheck}g_aXk(e){e.scrollTop=e.scrollHeight}};g_aVq.g_aWm(e)}{const e=class extends g_aUJ{constructor(e){super(e,"mouse"),this.g_aUU("cursor",e=>this.g_aXl(e))}g_aXl(e){document.body.style.cursor=e}};g_aVq.g_aWm(e)}{const e=class extends g_aUJ{constructor(e){super(e,"browser"),this.g_amE="",this.g_aUU("get-initial-state",e=>this.g_aXm(e)),this.g_aUU("ready-for-sw-messages",()=>this.g_aXn()),this.g_aUU("alert",e=>this.g_aXo(e)),this.g_aUU("close",()=>this.g_aXp()),this.g_aUU("set-focus",e=>this.g_aVg(e)),this.g_aUU("vibrate",e=>this.g_aXq(e)),this.g_aUU("lock-orientation",e=>this.g_aXr(e)),this.g_aUU("unlock-orientation",()=>this.g_aXs()),this.g_aUU("navigate",e=>this.g_aXt(e)),this.g_aUU("request-fullscreen",e=>this.g_aXu(e)),this.g_aUU("exit-fullscreen",()=>this.g_aXv()),window.addEventListener("online",()=>this.g_aFk(!0)),window.addEventListener("offline",()=>this.g_aFk(!1)),document.addEventListener("backbutton",()=>this.g_aXw()),"undefined"!=typeof Windows&&Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",e=>this.g_aXx(e))}g_aXm(e){return this.g_amE=e.exportType,{location:location.toString(),isOnline:!!navigator.onLine,referrer:document.referrer,title:document.title,isCookieEnabled:!!navigator.cookieEnabled,screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,isScirraArcade:"undefined"!=typeof window.is_scirra_arcade}}g_aXn(){window.C3_RegisterSW&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(e=>this.g_aUN("sw-message",e.data))}g_aFk(e){this.g_aUN("online-state",{isOnline:e})}g_aXw(){this.g_aUN("backbutton")}g_aXx(e){e.handled=!0,this.g_aUN("backbutton")}g_aXy(){return"nwjs"===this.g_amE?nw.Window.get():null}g_aXo(e){alert(e.message)}g_aXp(){navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():window.close()}g_aVg(e){const _=e.isFocus;if("nwjs"===this.g_amE){const e=this.g_aXy();_?e.focus():e.blur()}else _?window.focus():window.blur()}g_aXq(e){navigator.vibrate&&navigator.vibrate(e.pattern)}g_aXr(e){const _=e.orientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(_).catch(e=>console.warn("[Construct 3] Failed to lock orientation: ",e));else try{let e=!1;screen.lockOrientation?e=screen.lockOrientation(_):screen.webkitLockOrientation?e=screen.webkitLockOrientation(_):screen.mozLockOrientation?e=screen.mozLockOrientation(_):screen.msLockOrientation&&(e=screen.msLockOrientation(_)),e||console.warn("[Construct 3] Failed to lock orientation")}catch(e){console.warn("[Construct 3] Failed to lock orientation: ",e)}}g_aXs(){try{screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()}catch(e){}}g_aXt(e){const a=e.type;if("back"===a)navigator.app&&navigator.app.backHistory?navigator.app.backHistory():window.back();else if("forward"===a)window.forward();else if("home"===a)window.g_aXz();else if("reload"===a)location.reload();else if("url"===a){const a=e.url,_=e.target,g=e.exportType;"windows-uwp"===g&&"undefined"!=typeof Windows?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(a)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(a,{openExternal:!0}):"cordova"===g?window.open(a,"_system"):"preview"===g?window.open(a,"_blank"):!this.g_aFj&&(2===_?window.top.location=a:1===_?window.parent.location=a:window.location=a)}else if("new-window"===a){const a=e.url,_=e.tag,g=e.exportType;"windows-uwp"===g&&"undefined"!=typeof Windows?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(a)):navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(a,{openExternal:!0}):"cordova"===g?window.open(a,"_system"):window.open(a,_)}}g_aXu(e){const a={navigationUI:"auto"},_=e.navUI;1===_?a.navigationUI="hide":2===_&&(a.navigationUI="show");const g=document.documentElement;g.requestFullscreen?g.requestFullscreen(a):g.mozRequestFullScreen?g.mozRequestFullScreen(a):g.msRequestFullscreen?g.msRequestFullscreen(a):g.webkitRequestFullScreen&&("undefined"==typeof Element.ALLOW_KEYBOARD_INPUT?g.webkitRequestFullScreen():g.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT))}g_aXv(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}};g_aVq.g_aWm(e)}{function e(e,_){return e.length===_.length&&(e===_||e.toLowerCase()===_.toLowerCase())}const a=class extends g_aUJ{constructor(e){super(e,"audio"),this.g_aXA=null,this.g_aXB=null,this.g_aXC=!1,this.g_aXD=()=>this.g_aXE(),this.g_aXF=[],this.g_aXG=[],this.g_aXH=null,this.g_aXI="",this.g_aXJ=-1,this.g_aXK=new Map,this.g_aGS=1,this.g_aGT=!1,this.g_aGF=0,this.g_ahD=1,this.g_anQ=0,this.g_aGI="HRTF",this.g_aGJ="inverse",this.g_aXL=600,this.g_aGO=1e4,this.g_aGP=1,this.g_aXM=!1,this.g_aXN=!1,this.g_aXO=this.g_aov.g_AP("audio/webm; codecs=opus"),this.g_aXP=new Map,this.g_aXQ=new Set,this.g_aXR=!1,this.g_aXS="",this.g_aXT=null,self.C3Audio_OnMicrophoneStream=(e,a)=>this.g_aXU(e,a),this.g_aXV=null,self.C3Audio_GetOutputStream=()=>this.g_aXW(),this.g_aUW([["create-audio-context",e=>this.g_aXX(e)],["play",e=>this.g_aXY(e)],["stop",e=>this.g_aPO(e)],["stop-all",()=>this.g_aXZ()],["set-paused",e=>this.g_aX_(e)],["set-volume",e=>this.g_aX$(e)],["fade-volume",e=>this.g_aYa(e)],["set-master-volume",e=>this.g_aYb(e)],["set-muted",e=>this.g_aYc(e)],["set-silent",e=>this.g_aYd(e)],["set-looping",e=>this.g_aYe(e)],["set-playback-rate",e=>this.g_aYf(e)],["seek",e=>this.g_aYg(e)],["preload",e=>this.g_aYh(e)],["unload",e=>this.g_F_(e)],["unload-all",()=>this.g_aYi()],["set-suspended",e=>this.g_aYj(e)],["add-effect",e=>this.g_aYk(e)],["set-effect-param",e=>this.g_aYl(e)],["remove-effects",e=>this.g_aYm(e)],["tick",e=>this.g_Ip(e)],["load-state",e=>this.g_aYn(e)]])}async g_aXX(e){e.isWKWebView&&(this.g_aXM=!0),this.g_aGF=e.timeScaleMode,this.g_aGI=["equalpower","HRTF","soundfield"][e.panningModel],this.g_aGJ=["linear","inverse","exponential"][e.distanceModel],this.g_aXL=e.refDistance,this.g_aGO=e.maxDistance,this.g_aGP=e.rolloffFactor;const a={latencyHint:e.latencyHint};if("undefined"!=typeof AudioContext)this.g_aXA=new AudioContext(a);else if("undefined"!=typeof webkitAudioContext)this.g_aXA=new webkitAudioContext(a);else throw new Error("Web Audio API not supported");this.g_aXB=this.g_aXA.createGain(),this.g_aXB.connect(this.g_aXA.destination);const _=e.listenerPos;this.g_aXA.listener.setPosition(_[0],_[1],_[2]),this.g_aXA.listener.setOrientation(0,0,1,0,-1,0),window.addEventListener("pointerup",this.g_aXD,!0),window.addEventListener("touchend",this.g_aXD,!0),window.addEventListener("click",this.g_aXD,!0),window.addEventListener("keydown",this.g_aXD,!0),self.C3_GetAudioContextCurrentTime=()=>this.g_aYo();try{await Promise.all(e.preloadList.map(e=>this.g_aYp(e.originalUrl,e.url,e.type,!1)))}catch(e){console.error("[Construct 3] Preloading sounds failed: ",e)}return{sampleRate:this.g_aXA.sampleRate}}g_aXE(){if(!this.g_aXC){const e=this.g_aXA;"suspended"===e.state&&e.resume&&e.resume();const a=e.createBuffer(1,220,22050),_=e.createBufferSource();_.buffer=a,_.connect(e.destination),_.start(0),"running"===e.state&&(this.g_aXC=!0,window.removeEventListener("pointerup",this.g_aXD,!0),window.removeEventListener("touchend",this.g_aXD,!0),window.removeEventListener("click",this.g_aXD,!0),window.removeEventListener("keydown",this.g_aXD,!0),this.g_aXD=null)}}g_aYq(){return this.g_aXA}g_aYo(){return this.g_aXA.currentTime}g_aYr(){return this.g_aXB}g_aYs(e){const a=this.g_aXP.get(e.toLowerCase());return a?a[0].g_aYt():this.g_aYr()}g_aYu(e,_){e=e.toLowerCase();let g=this.g_aXP.get(e);g||(g=[],this.g_aXP.set(e,g)),_.g_ajk(g.length),_.g_aYv(e),g.push(_),this.g_aYw(e)}g_aYw(e){let a=this.g_aYr();const _=this.g_aXP.get(e);if(_&&_.length){a=_[0].g_aYt();for(let e=0,a=_.length;e<a;++e){const g=_[e];e+1===a?g.g_aYx(this.g_aYr()):g.g_aYx(_[e+1].g_aYt())}}for(const _ of this.g_aYy(e))_.g_aYz(a);this.g_aXT&&this.g_aXS===e&&(this.g_aXT.disconnect(),this.g_aXT.connect(a))}g_aYA(){return this.g_aGS}g_aHu(){return this.g_aGT}g_aYB(){return this.g_aGF}g_Jh(){return this.g_ahD}g_EK(){return this.g_anQ}g_aYC(){return this.g_aXM}g_aYD(){return this.g_aXO}g_aYE(){this.g_aXN=!0}g_aYF(){return this.g_aGI}g_aYG(){return this.g_aGJ}g_aYH(){return this.g_aXL}g_aYI(){return this.g_aGO}g_aYJ(){return this.g_aGP}g_aYK(e,a){return a?this.g_aov.g_adC(e).then(e=>{const a=this.g_aXA.createBuffer(1,e.length,48e3),_=a.getChannelData(0);return _.set(e),a}):new Promise((a,_)=>{this.g_aXA.decodeAudioData(e,a,_)})}g_aWp(e){this.g_aov.g_aWp(e)}g_aWq(e){this.g_aov.g_aWq(e)}g_aYL(a){let _=0;for(let g=0,e=this.g_aXG.length;g<e;++g){const t=this.g_aXG[g];this.g_aXG[_]=t,t.g_aYM()===a?t.g_em():++_}this.g_aXG.length=_}g_aYN(){let e=0;for(let a=0,_=this.g_aXF.length;a<_;++a){const _=this.g_aXF[a];this.g_aXF[e]=_,_.g_aYO()?_.g_em():++e}this.g_aXF.length=e}*g_aYy(a){if(a)for(const _ of this.g_aXG)e(_.g_aYP(),a)&&(yield _);else this.g_aXH&&!this.g_aXH.g_aYQ()&&(yield this.g_aXH)}async g_aYp(_,a,g,t,n){for(const e of this.g_aXF)if(e.g_aYR()===a)return await e.g_AE(),e;if(n)return null;t&&(this.g_aXM||this.g_aXN)&&this.g_aYN();const e=g_aYS.g_pB(this,_,a,g,t);return this.g_aXF.push(e),await e.g_AE(),e}async g_aYT(_,a,t,n,i){for(const e of this.g_aXG)if(e.g_aYR()===a&&(e.g_aYU()||i))return e.g_aYV(n),e;const e=await this.g_aYp(_,a,t,i),o=e.g_adR(n);return this.g_aXG.push(o),o}g_aYW(e){let a=this.g_aXK.get(e);if(!a){let _=null;const g=new Promise(e=>_=e);a={g_aYX:0,promise:g,resolve:_},this.g_aXK.set(e,a)}a.g_aYX++}g_aYY(e){const a=this.g_aXK.get(e);if(!a)throw new Error("expected pending tag");a.g_aYX--,0===a.g_aYX&&(a.resolve(),this.g_aXK.delete(e))}g_aYZ(e){e||(e=this.g_aXI);const _=this.g_aXK.get(e);return _?_.promise:Promise.resolve()}g_aY_(){if(0<this.g_aXQ.size)return void this.g_abK();for(const e of this.g_aXG)if(e.g_VM())return void this.g_abK()}g_Jj(){for(const a of this.g_aXQ)a.g_Jj();const e=this.g_aYo();for(const a of this.g_aXG)a.g_Jj(e);const a=this.g_aXG.filter(a=>a.g_VM()).map(a=>a.g_aY$());this.g_aUN("state",{tickCount:this.g_aXJ,audioInstances:a,analysers:[...this.g_aXQ].map(a=>a.g_aZa())}),0===a.length&&0===this.g_aXQ.size&&this.g_abv()}g_aZb(e,a){this.g_aUN("trigger",{type:e,tag:a})}async g_aXY(_){const a=_.originalUrl,t=_.url,n=_.type,o=_.isMusic,e=_.tag,r=_.isLooping,g=_.vol,s=_.pos,i=_.panning;let d=_.off;if(0<d&&!_.trueClock)if(this.g_aXA.getOutputTimestamp){const e=this.g_aXA.getOutputTimestamp();d=d-e.performanceTime/1e3+e.contextTime}else d=d-performance.now()/1e3+this.g_aXA.currentTime;this.g_aXI=e,this.g_aYW(e);try{this.g_aXH=await this.g_aYT(a,t,n,e,o),i?(this.g_aXH.g_aZc(!0),this.g_aXH.g_aZd(i.x,i.y,i.angle,i.innerAngle,i.outerAngle,i.outerGain),i.hasOwnProperty("uid")&&this.g_aXH.g_aZe(i.uid)):this.g_aXH.g_aZc(!1),this.g_aXH.g_KS(r,g,s,d)}catch(e){return void console.error("[Construct 3] Audio: error starting playback: ",e)}finally{this.g_aYY(e)}this.g_abK()}g_aPO(e){const a=e.tag;for(const _ of this.g_aYy(a))_.g_Iz()}g_aXZ(){for(const e of this.g_aXG)e.g_Iz()}g_aX_(e){const a=e.tag,_=e.paused;for(const g of this.g_aYy(a))_?g.g_aTM():g.g_KR();this.g_aY_()}g_aX$(e){const a=e.tag,_=e.vol;for(const g of this.g_aYy(a))g.g_aHD(_)}async g_aYa(_){const a=_.tag,g=_.vol,t=_.duration,n=_.stopOnEnd;await this.g_aYZ(a);for(const e of this.g_aYy(a))e.g_aHE(g,t,n);this.g_aY_()}g_aYb(e){this.g_aGS=e.vol;for(const a of this.g_aXG)a.g_aZf()}g_aYc(e){const a=e.tag,_=e.isMuted;for(const g of this.g_aYy(a))g.g_aHC(_)}g_aYd(e){this.g_aGT=e.isSilent,this.g_aov.g_aHK(this.g_aGT);for(const a of this.g_aXG)a.g_aZg()}g_aYe(e){const a=e.tag,_=e.isLooping;for(const g of this.g_aYy(a))g.g_aHB(_)}g_aYf(e){const a=e.tag,_=e.rate;for(const g of this.g_aYy(a))g.g_Ke(_)}g_aYg(e){const a=e.tag,_=e.pos;for(const g of this.g_aYy(a))g.g_aHJ(_)}async g_aYh(_){const a=_.originalUrl,g=_.url,t=_.type,n=_.isMusic;try{await this.g_aYT(a,g,t,"",n)}catch(e){console.error("[Construct 3] Audio: error preloading: ",e)}}async g_F_(_){const a=_.url,g=_.type,t=_.isMusic,n=await this.g_aYp("",a,g,t,!0);if(n){n.g_em();const e=this.g_aXF.indexOf(n);-1!==e&&this.g_aXF.splice(e,1)}}g_aYi(){for(const e of this.g_aXF)e.g_em();this.g_aXF.length=0}g_aYj(e){const a=e.isSuspended;!a&&this.g_aXA.resume&&this.g_aXA.resume();for(const _ of this.g_aXG)_.g_api(a);a&&this.g_aXA.suspend&&this.g_aXA.suspend()}g_Ip(e){if(this.g_ahD=e.timeScale,this.g_anQ=e.gameTime,this.g_aXJ=e.tickCount,0!==this.g_aGF)for(const e of this.g_aXG)e.g_aZh();const a=e.listenerPos;a&&this.g_aXA.listener.setPosition(a[0],a[1],a[2]);for(const _ of e.instPans){const e=_.uid;for(const a of this.g_aXG)a.g_CJ()===e&&a.g_aZi(_.x,_.y,_.angle)}}async g_aYk(_){const a=_.type,g=_.tag,t=_.params;let n;if("filter"===a)n=new g_aZj(this,...t);else if("delay"===a)n=new g_aZk(this,...t);else if("convolution"===a){let a=null;try{a=await this.g_aYp(_.bufferOriginalUrl,_.bufferUrl,_.bufferType,!1)}catch(e){return void console.log("[Construct 3] Audio: error loading convolution: ",e)}n=new g_aZl(this,a.g_aZm(),...t),n.g_aZn(_.bufferOriginalUrl,_.bufferUrl,_.bufferType)}else if("flanger"===a)n=new g_aZo(this,...t);else if("phaser"===a)n=new g_aZp(this,...t);else if("gain"===a)n=new g_aZq(this,...t);else if("tremolo"===a)n=new g_aZr(this,...t);else if("ringmod"===a)n=new g_aZs(this,...t);else if("distortion"===a)n=new g_aZt(this,...t);else if("compressor"===a)n=new g_aZu(this,...t);else if("analyser"===a)n=new g_aZv(this,...t);else throw new Error("invalid effect type");this.g_aYu(g,n),this.g_aZw()}g_aYl(_){const a=_.tag,t=_.index,n=_.param,i=_.value,e=_.ramp,o=_.time,g=this.g_aXP.get(a);!g||0>t||t>=g.length||(g[t].g_aZx(n,i,e,o),this.g_aZw())}g_aYm(e){const a=e.tag.toLowerCase(),_=this.g_aXP.get(a);if(_&&_.length){for(const e of _)e.g_em();this.g_aXP.delete(a),this.g_aYw(a)}}g_aZy(e){this.g_aXQ.add(e),this.g_aY_()}g_aZz(e){this.g_aXQ.delete(e)}g_aZw(){this.g_aXR||(this.g_aXR=!0,Promise.resolve().then(()=>this.g_aZA()))}g_aZA(){const e={};for(const[a,_]of this.g_aXP)e[a]=_.map(e=>e.g_aY$());this.g_aUN("fxstate",{fxstate:e}),this.g_aXR=!1}async g_aYn(e){const _=e.saveLoadMode;if(3!==_)for(const e of this.g_aXG)e.g_aYO()&&1===_||!e.g_aYO()&&2===_||e.g_Iz();for(const _ of this.g_aXP.values())for(const e of _)e.g_em();this.g_aXP.clear(),this.g_ahD=e.timeScale,this.g_anQ=e.gameTime;const a=e.listenerPos;this.g_aXA.listener.setPosition(a[0],a[1],a[2]),this.g_aGT=e.isSilent,this.g_aov.g_aHK(this.g_aGT),this.g_aGS=e.masterVolume;const g=[];for(const a of Object.values(e.effects))g.push(Promise.all(a.map(e=>this.g_aYk(e))));await Promise.all(g),await Promise.all(e.playing.map(e=>this.g_aZB(e,_))),this.g_aY_()}async g_aZB(_,a){if(3===a)return;const t=_.bufferOriginalUrl,n=_.bufferUrl,o=_.bufferType,e=_.isMusic,r=_.tag,g=_.isLooping,s=_.volume,i=_.playbackTime;if(e&&1===a)return;if(!e&&2===a)return;let d=null;try{d=await this.g_aYT(t,n,o,r,e)}catch(e){return void console.error("[Construct 3] Audio: error loading audio state: ",e)}d.g_aZC(_.pan),d.g_KS(g,s,i,0),_.isPlaying||d.g_aTM(),d.g_aZD(_)}g_aXU(e,a){this.g_aXT&&this.g_aXT.disconnect(),this.g_aXS=a.toLowerCase(),this.g_aXT=this.g_aXA.createMediaStreamSource(e),this.g_aXT.connect(this.g_aYs(this.g_aXS))}g_aXW(){return this.g_aXV||(this.g_aXV=this.g_aXA.createMediaStreamDestination(),this.g_aXB.connect(this.g_aXV)),this.g_aXV.stream}};g_aVq.g_aWm(a)}"use strict",self.g_aYS=class{constructor(_,a,g,t,n){this.g_aZE=_,this.g_aZF=a,this.g_Bd=g,this.g_ko=t,this.g_aZG=n,this.g_aZH="",this.g_aZI="not-loaded",this.g_Bi=null}g_em(){this.g_aZI="not-loaded",this.g_aZE=null,this.g_Bi=null}static g_pB(_,a,g,t,n){const e="audio/webm; codecs=opus"===t&&!_.g_aYD();return n&&e&&_.g_aYE(),!n||_.g_aYC()||e?new g_aZJ(_,a,g,t,n,e):new g_aZK(_,a,g,t,n)}g_adR(e){return"html5"===this.g_aZH?new g_aZL(this.g_aZE,this,e):new g_aZM(this.g_aZE,this,e)}g_FU(){}g_AE(){return this.g_Bi||(this.g_Bi=this.g_FU()),this.g_Bi}g_Bj(){}g_aZN(){}g_aZO(){return"failed"===this.g_aZI}g_aYq(){return this.g_aZE.g_aYq()}g_aZP(){return this.g_aZH}g_aZQ(){return this.g_aZF}g_aYR(){return this.g_Bd}g_aZR(){return this.g_ko}g_aYO(){return this.g_aZG}g_afz(){}},"use strict",self.g_aZK=class extends g_aYS{constructor(_,a,g,t,n){super(_,a,g,t,n),this.g_aZH="html5",this.g_aZS=new Audio,this.g_aZS.crossOrigin="anonymous",this.g_aZS.autoplay=!1,this.g_aZS.preload="auto",this.g_aZT=null,this.g_aZU=null,this.g_aZV=!1,this.g_aZS.addEventListener("canplaythrough",()=>this.g_aZV=!0),this.g_aZW=this.g_aYq().createGain(),this.g_aZX=null,this.g_aZS.addEventListener("canplay",()=>{this.g_aZT&&(this.g_aZI="loaded",this.g_aZT(),this.g_aZT=null,this.g_aZU=null),this.g_aZX||!this.g_aZS||(this.g_aZX=this.g_aYq().createMediaElementSource(this.g_aZS),this.g_aZX.connect(this.g_aZW))}),this.onended=null,this.g_aZS.addEventListener("ended",()=>{this.onended&&this.onended()}),this.g_aZS.addEventListener("error",e=>this.g_aIZ(e))}g_em(){this.g_aZE.g_aYL(this),this.g_aZW.disconnect(),this.g_aZW=null,this.g_aZX.disconnect(),this.g_aZX=null,this.g_aZS&&!this.g_aZS.paused&&this.g_aZS.pause(),this.onended=null,this.g_aZS=null,super.g_em()}g_FU(){return this.g_aZI="loading",new Promise((e,a)=>{this.g_aZT=e,this.g_aZU=a,this.g_aZS.src=this.g_Bd})}g_aIZ(e){console.error(`[Construct 3] Audio '${this.g_Bd}' error: `,e),this.g_aZU&&(this.g_aZI="failed",this.g_aZU(e),this.g_aZT=null,this.g_aZU=null)}g_Bj(){const e=4<=this.g_aZS.readyState;return e&&(this.g_aZV=!0),e||this.g_aZV}g_aZN(){return this.g_Bj()}g_aZY(){return this.g_aZS}g_aZZ(){return this.g_aZW}g_afz(){return this.g_aZS.duration}},"use strict",self.g_aZJ=class extends g_aYS{constructor(_,a,g,t,n,e){super(_,a,g,t,n),this.g_aZH="webaudio",this.g_aZ_=null,this.g_aZ$=null,this.g_a_a=!!e}g_em(){this.g_aZE.g_aYL(this),this.g_aZ_=null,this.g_aZ$=null,super.g_em()}async g_a_b(){if(this.g_aZ_)return this.g_aZ_;const e=this.g_aZE.g_aUX();if("cordova"===e.g_apV()&&e.g_fT(this.g_Bd))this.g_aZ_=await e.g_As(this.g_Bd);else{const e=await fetch(this.g_Bd);if(!e.ok)throw new Error(`error fetching audio data: ${e.status} ${e.statusText}`);this.g_aZ_=await e.arrayBuffer()}}async g_a_c(){return this.g_aZ$?this.g_aZ$:void(this.g_aZ$=await this.g_aZE.g_aYK(this.g_aZ_,this.g_a_a),this.g_aZ_=null)}async g_FU(){try{this.g_aZI="loading",await this.g_a_b(),await this.g_a_c(),this.g_aZI="loaded"}catch(e){this.g_aZI="failed",console.error(`[Construct 3] Failed to load audio '${this.g_Bd}': `,e)}}g_Bj(){return!!(this.g_aZ_||this.g_aZ$)}g_aZN(){return!!this.g_aZ$}g_aZm(){return this.g_aZ$}g_afz(){return this.g_aZ$?this.g_aZ$.duration:0}},"use strict";{function _(_){return _*e}const e=180/Math.PI;self.g_a_d=class{constructor(e,a,_){this.g_aZE=e,this.g_vg=a,this.g_a_e=_,this.g_a_f=this.g_aYq().createGain(),this.g_a_f.connect(this.g_aYr()),this.g_a_g=null,this.g_a_h=!1,this.g_Sw=!0,this.g_a_i=!1,this.g_a_j=!1,this.g_ZD=!1,this.g_a_k=1,this.g_a_l=!1,this.g_Jw=1;const g=this.g_aZE.g_aYB();this.g_a_m=1===g&&!this.g_aYO()||2===g,this.g_a_n=-1,this.g_a_o=-1,this.g_a_p=!1}g_em(){this.g_aZE=null,this.g_vg=null,this.g_a_g&&(this.g_a_g.disconnect(),this.g_a_g=null),this.g_a_f.disconnect(),this.g_a_f=null}g_aYq(){return this.g_aZE.g_aYq()}g_aYr(){return this.g_aZE.g_aYs(this.g_a_e)}g_aYA(){return this.g_aZE.g_aYA()}g_aIz(){return this.g_a_m?this.g_aZE.g_EK():performance.now()/1e3}g_aZQ(){return this.g_vg.g_aZQ()}g_aYR(){return this.g_vg.g_aYR()}g_aZR(){return this.g_vg.g_aZR()}g_aYM(){return this.g_vg}g_aYO(){return this.g_vg.g_aYO()}g_aYV(e){this.g_a_e=e}g_aYP(){return this.g_a_e}g_aYQ(){}g_aYU(){}g_Kh(){return!this.g_Sw&&!this.g_a_i&&!this.g_aYQ()}g_VM(){return!this.g_Sw&&!this.g_aYQ()}g_a_q(){}g_afz(e){let a=this.g_vg.g_afz();return e&&(a/=this.g_Jw||.001),a}g_KS(){}g_Iz(){}g_aTM(){}g_a_r(){return this.g_a_i}g_KR(){}g_aHD(e){this.g_a_k=e,this.g_a_f.gain.cancelScheduledValues(0),this.g_a_o=-1,this.g_a_f.gain.value=this.g_a_s()}g_aHE(_,g,t){if(!this.g_a_t()){_*=this.g_aYA();const a=this.g_a_f.gain;a.cancelScheduledValues(0);const n=this.g_aZE.g_aYo(),e=n+g;a.setValueAtTime(this.g_a_s(),n),a.linearRampToValueAtTime(_,e),this.g_a_k=_,this.g_a_o=e,this.g_a_p=t}}g_aZf(){this.g_aHD(this.g_a_k)}g_Jj(e){-1!==this.g_a_o&&e>=this.g_a_o&&(this.g_a_o=-1,this.g_a_p&&this.g_Iz(),this.g_aZE.g_aZb("fade-ended",this.g_a_e))}g_a_s(){const e=this.g_a_k*this.g_aYA();return isFinite(e)?e:0}g_aHC(e){e=!!e,this.g_a_l===e||(this.g_a_l=e,this.g_aZg())}g_a_t(){return this.g_a_l}g_aHu(){return this.g_aZE.g_aHu()}g_aZg(){}g_aHB(){}g_Xs(){return this.g_ZD}g_Ke(e){this.g_Jw===e||(this.g_Jw=e,this.g_aZh())}g_aZh(){}g_Kf(){return this.g_Jw}g_aHJ(){}g_api(){}g_aZc(e){e=!!e,this.g_a_h===e||(this.g_a_h=e,this.g_a_h?(!this.g_a_g&&(this.g_a_g=this.g_aYq().createPanner(),this.g_a_g.panningModel=this.g_aZE.g_aYF(),this.g_a_g.distanceModel=this.g_aZE.g_aYG(),this.g_a_g.refDistance=this.g_aZE.g_aYH(),this.g_a_g.maxDistance=this.g_aZE.g_aYI(),this.g_a_g.rolloffFactor=this.g_aZE.g_aYJ()),this.g_a_f.disconnect(),this.g_a_f.connect(this.g_a_g),this.g_a_g.connect(this.g_aYr())):(this.g_a_g.disconnect(),this.g_a_f.disconnect(),this.g_a_f.connect(this.g_aYr())))}g_aZd(a,t,n,i,e,o){this.g_a_h&&(this.g_aZi(a,t,n),this.g_a_g.coneInnerAngle=_(i),this.g_a_g.coneOuterAngle=_(e),this.g_a_g.coneOuterGain=o)}g_aZi(e,a,_){this.g_a_h&&(this.g_a_g.setPosition(e,a,0),this.g_a_g.setOrientation(Math.cos(_),Math.sin(_),0))}g_aZe(e){this.g_a_n=e}g_CJ(){return this.g_a_n}g_a_u(){}g_aYz(e){const a=this.g_a_g||this.g_a_f;a.disconnect(),a.connect(e)}g_aY$(){return{tag:this.g_a_e,duration:this.g_afz(),volume:this.g_a_k,isPlaying:this.g_Kh(),playbackTime:this.g_a_q(),playbackRate:this.g_Kf(),uid:this.g_a_n,bufferOriginalUrl:this.g_aZQ(),bufferUrl:"",bufferType:this.g_aZR(),isMusic:this.g_aYO(),isLooping:this.g_Xs(),isMuted:this.g_a_t(),resumePosition:this.g_a_u(),pan:this.g_a_v()}}g_aZD(e){this.g_Ke(e.playbackRate),this.g_aHC(e.isMuted)}g_a_v(){if(!this.g_a_g)return null;const e=this.g_a_g;return{pos:[e.positionX.value,e.positionY.value,e.positionZ.value],orient:[e.orientationX.value,e.orientationY.value,e.orientationZ.value],cia:e.coneInnerAngle,coa:e.coneOuterAngle,cog:e.coneOuterGain,uid:this.g_a_n}}g_aZC(e){if(!e)return void this.g_aZc(!1);this.g_aZc(!0);const a=this.g_a_g;a.setPosition(...a.pos),a.setOrientation(...a.orient),a.coneInnerAngle=a.cia,a.coneOuterAngle=a.coa,a.coneOuterGain=a.cog,this.g_a_n=a.uid}}}"use strict",self.g_aZL=class extends g_a_d{constructor(e,a,_){super(e,a,_),this.g_vg.g_aZZ().connect(this.g_a_f),this.g_vg.onended=()=>this.g_a_w()}g_em(){this.g_Iz(),this.g_vg.g_aZZ().disconnect(),super.g_em()}g_aZY(){return this.g_vg.g_aZY()}g_a_w(){this.g_Sw=!0,this.g_a_n=-1,this.g_aZE.g_aZb("ended",this.g_a_e)}g_aYQ(){return this.g_aZY().ended}g_aYU(){return!!this.g_Sw||this.g_aYQ()}g_a_q(e){let a=this.g_aZY().currentTime;return e&&(a*=this.g_Jw),this.g_ZD||(a=Math.min(a,this.g_afz())),a}g_KS(e,a,_){const g=this.g_aZY();if(1!==g.playbackRate&&(g.playbackRate=1),g.loop!==e&&(g.loop=e),this.g_aHD(a),g.muted&&(g.muted=!1),g.currentTime!==_)try{g.currentTime=_}catch(e){console.warn(`[Construct 3] Exception seeking audio '${this.g_vg.g_aYR()}' to position '${_}': `,e)}this.g_aZE.g_aWp(g),this.g_Sw=!1,this.g_a_i=!1,this.g_ZD=e,this.g_Jw=1}g_Iz(){const e=this.g_aZY();e.paused||e.pause(),this.g_aZE.g_aWq(e),this.g_Sw=!0,this.g_a_i=!1,this.g_a_n=-1}g_aTM(){if(!(this.g_a_i||this.g_Sw||this.g_aYQ())){const e=this.g_aZY();e.paused||e.pause(),this.g_aZE.g_aWq(e),this.g_a_i=!0}}g_KR(){!this.g_a_i||this.g_Sw||this.g_aYQ()||(this.g_aZE.g_aWp(this.g_aZY()),this.g_a_i=!1)}g_aZg(){this.g_aZY().muted=this.g_a_l||this.g_aHu()}g_aHB(e){e=!!e,this.g_ZD===e||(this.g_ZD=e,this.g_aZY().loop=e)}g_aZh(){let e=this.g_Jw;this.g_a_m&&(e*=this.g_aZE.g_Jh());try{this.g_aZY().playbackRate=e}catch(a){console.warn(`[Construct 3] Unable to set playback rate '${e}':`,a)}}g_aHJ(e){if(!(this.g_Sw||this.g_aYQ()))try{this.g_aZY().currentTime=e}catch(a){console.warn(`[Construct 3] Error seeking audio to '${e}': `,a)}}g_a_u(){return this.g_a_q()}g_api(e){e?this.g_Kh()?(this.g_aZY().pause(),this.g_a_j=!0):this.g_a_j=!1:this.g_a_j&&(this.g_aZE.g_aWp(this.g_aZY()),this.g_a_j=!1)}},"use strict",self.g_aZM=class extends g_a_d{constructor(e,a,_){super(e,a,_),this.g_a_x=null,this.g_a_y=e=>this.g_a_w(e),this.g_a_z=!0,this.g_a_A=null,this.g_anL=0,this.g_a_B=0,this.g_a_C=1}g_em(){this.g_Iz(),this.g_a_D(),this.g_a_y=null,super.g_em()}g_a_D(){this.g_a_x&&this.g_a_x.disconnect(),this.g_a_x=null,this.g_a_A=null}g_a_w(e){this.g_a_i||this.g_a_j||e.target!==this.g_a_A||(this.g_a_z=!0,this.g_Sw=!0,this.g_a_n=-1,this.g_a_D(),this.g_aZE.g_aZb("ended",this.g_a_e))}g_aYQ(){return!(!this.g_Sw&&this.g_a_x&&this.g_a_x.loop)&&!this.g_a_i&&this.g_a_z}g_aYU(){return!this.g_a_x||this.g_Sw||this.g_aYQ()}g_a_q(e){let a=0;return a=this.g_a_i?this.g_a_B:this.g_aIz()-this.g_anL,e&&(a*=this.g_Jw),this.g_ZD||(a=Math.min(a,this.g_afz())),a}g_KS(e,a,_,g){this.g_a_C=1,this.g_aHD(a),this.g_a_D(),this.g_a_x=this.g_aYq().createBufferSource(),this.g_a_x.buffer=this.g_vg.g_aZm(),this.g_a_x.connect(this.g_a_f),this.g_a_A=this.g_a_x,this.g_a_x.onended=this.g_a_y,this.g_a_x.loop=e,this.g_a_x.start(g,_),this.g_a_z=!1,this.g_Sw=!1,this.g_a_i=!1,this.g_ZD=e,this.g_Jw=1,this.g_anL=this.g_aIz()-_}g_Iz(){this.g_a_x&&this.g_a_x.stop(0),this.g_Sw=!0,this.g_a_i=!1,this.g_a_n=-1}g_aTM(){this.g_a_i||this.g_Sw||this.g_aYQ()||(this.g_a_B=this.g_a_q(!0),this.g_ZD&&(this.g_a_B%=this.g_afz()),this.g_a_i=!0,this.g_a_x.stop(0))}g_KR(){!this.g_a_i||this.g_Sw||this.g_aYQ()||(this.g_a_D(),this.g_a_x=this.g_aYq().createBufferSource(),this.g_a_x.buffer=this.g_vg.g_aZm(),this.g_a_x.connect(this.g_a_f),this.g_a_A=this.g_a_x,this.g_a_x.onended=this.g_a_y,this.g_a_x.loop=this.g_ZD,this.g_aZf(),this.g_aZh(),this.g_anL=this.g_aIz()-this.g_a_B/(this.g_Jw||.001),this.g_a_x.start(0,this.g_a_B),this.g_a_i=!1)}g_a_s(){return super.g_a_s()*this.g_a_C}g_aZg(){this.g_a_C=this.g_a_l||this.g_aHu()?0:1,this.g_aZf()}g_aHB(e){e=!!e,this.g_ZD===e||(this.g_ZD=e,this.g_a_x&&(this.g_a_x.loop=e))}g_aZh(){let e=this.g_Jw;this.g_a_m&&(e*=this.g_aZE.g_Jh()),this.g_a_x&&(this.g_a_x.playbackRate.value=e)}g_aHJ(e){this.g_Sw||this.g_aYQ()||(this.g_a_i?this.g_a_B=e:(this.g_aTM(),this.g_a_B=e,this.g_KR()))}g_a_u(){return this.g_a_B}g_api(e){e?this.g_Kh()?(this.g_a_j=!0,this.g_a_B=this.g_a_q(!0),this.g_ZD&&(this.g_a_B%=this.g_afz()),this.g_a_x.stop(0)):this.g_a_j=!1:this.g_a_j&&(this.g_a_D(),this.g_a_x=this.g_aYq().createBufferSource(),this.g_a_x.buffer=this.g_vg.g_aZm(),this.g_a_x.connect(this.g_a_f),this.g_a_A=this.g_a_x,this.g_a_x.onended=this.g_a_y,this.g_a_x.loop=this.g_ZD,this.g_aZf(),this.g_aZh(),this.g_anL=this.g_aIz()-this.g_a_B/(this.g_Jw||.001),this.g_a_x.start(0,this.g_a_B),this.g_a_j=!1)}g_aZD(e){super.g_aZD(e),this.g_a_B=e.resumePosition}},"use strict";{function _(e){return Math.pow(10,e/20)}function g(a){return Math.max(Math.min(_(a),1),0)}function t(e){return 20*(Math.log(e)/2.302585092994046)}function n(e){return t(Math.max(Math.min(e,1),0))}function i(e,a){return 1-Math.exp(-a*e)}class a{constructor(e){this.g_aZE=e,this.g_aXA=e.g_aYq(),this.g_BS=-1,this.g_a_e="",this.g_ko="",this.g_a_E=null}g_em(){this.g_aXA=null}g_ajk(e){this.g_BS=e}g_Dl(){return this.g_BS}g_aYv(e){this.g_a_e=e}g_aYP(){return this.g_a_e}g_a_F(){return this.g_aXA.createGain()}g_aYt(){}g_aYx(){}g_a_G(_,a,g,t){if(_.cancelScheduledValues(0),0===t)return void(_.value=a);const n=this.g_aXA.currentTime;t+=n,0===g?_.setValueAtTime(a,t):1===g?(_.setValueAtTime(_.value,n),_.linearRampToValueAtTime(a,t)):2===g?(_.setValueAtTime(_.value,n),_.exponentialRampToValueAtTime(a,t)):void 0}g_aY$(){return{type:this.g_ko,tag:this.g_a_e,params:this.g_a_E}}}self.g_aZj=class extends a{constructor(_,a,t,n,i,e,o){super(_),this.g_ko="filter",this.g_a_E=[a,t,n,i,e,o],this.g_a_H=this.g_a_F(),this.g_a_I=this.g_a_F(),this.g_a_I.gain.value=o,this.g_a_J=this.g_a_F(),this.g_a_J.gain.value=1-o,this.g_a_K=this.g_aXA.createBiquadFilter(),this.g_a_K.type=a,this.g_a_K.frequency.value=t,this.g_a_K.detune.value=n,this.g_a_K.Q.value=i,this.g_a_K.gain.vlaue=e,this.g_a_H.connect(this.g_a_K),this.g_a_H.connect(this.g_a_J),this.g_a_K.connect(this.g_a_I)}g_em(){this.g_a_H.disconnect(),this.g_a_K.disconnect(),this.g_a_I.disconnect(),this.g_a_J.disconnect(),super.g_em()}g_aYx(e){this.g_a_I.disconnect(),this.g_a_I.connect(e),this.g_a_J.disconnect(),this.g_a_J.connect(e)}g_aYt(){return this.g_a_H}g_aZx(e,a,_,g){0===e?(a=Math.max(Math.min(a/100,1),0),this.g_a_E[5]=a,this.g_a_G(this.g_a_I.gain,a,_,g),this.g_a_G(this.g_a_J.gain,1-a,_,g)):1===e?(this.g_a_E[1]=a,this.g_a_G(this.g_a_K.frequency,a,_,g)):2===e?(this.g_a_E[2]=a,this.g_a_G(this.g_a_K.detune,a,_,g)):3===e?(this.g_a_E[3]=a,this.g_a_G(this.g_a_K.Q,a,_,g)):4===e?(this.g_a_E[4]=a,this.g_a_G(this.g_a_K.gain,a,_,g)):void 0}},self.g_aZk=class extends a{constructor(e,a,_,g){super(e),this.g_ko="delay",this.g_a_E=[a,_,g],this.g_a_H=this.g_a_F(),this.g_a_I=this.g_a_F(),this.g_a_I.gain.value=g,this.g_a_J=this.g_a_F(),this.g_a_J.gain.value=1-g,this.g_a_L=this.g_a_F(),this.g_a_M=this.g_aXA.createDelay(a),this.g_a_M.delayTime.value=a,this.g_a_N=this.g_a_F(),this.g_a_N.gain.value=_,this.g_a_H.connect(this.g_a_L),this.g_a_H.connect(this.g_a_J),this.g_a_L.connect(this.g_a_I),this.g_a_L.connect(this.g_a_M),this.g_a_M.connect(this.g_a_N),this.g_a_N.connect(this.g_a_L)}g_em(){this.g_a_H.disconnect(),this.g_a_I.disconnect(),this.g_a_J.disconnect(),this.g_a_L.disconnect(),this.g_a_M.disconnect(),this.g_a_N.disconnect(),super.g_em()}g_aYx(e){this.g_a_I.disconnect(),this.g_a_I.connect(e),this.g_a_J.disconnect(),this.g_a_J.connect(e)}g_aYt(){return this.g_a_H}g_aZx(_,a,t,n){0===_?(a=Math.max(Math.min(a/100,1),0),this.g_a_E[2]=a,this.g_a_G(this.g_a_I.gain,a,t,n),this.g_a_G(this.g_a_J.gain,1-a,t,n)):4===_?(this.g_a_E[1]=g(a),this.g_a_G(this.g_a_N.gain,g(a),t,n)):5===_?(this.g_a_E[0]=a,this.g_a_G(this.g_a_M.delayTime,a,t,n)):void 0}},self.g_aZl=class extends a{constructor(e,a,_,g){super(e),this.g_ko="convolution",this.g_a_E=[_,g],this.g_a_O="",this.g_a_P="",this.g_a_Q="",this.g_a_H=this.g_a_F(),this.g_a_I=this.g_a_F(),this.g_a_I.gain.value=g,this.g_a_J=this.g_a_F(),this.g_a_J.gain.value=1-g,this.g_a_R=this.g_aXA.createConvolver(),this.g_a_R.normalize=_,this.g_a_R.buffer=a,this.g_a_H.connect(this.g_a_R),this.g_a_H.connect(this.g_a_J),this.g_a_R.connect(this.g_a_I)}g_em(){this.g_a_H.disconnect(),this.g_a_R.disconnect(),this.g_a_I.disconnect(),this.g_a_J.disconnect(),super.g_em()}g_aYx(e){this.g_a_I.disconnect(),this.g_a_I.connect(e),this.g_a_J.disconnect(),this.g_a_J.connect(e)}g_aYt(){return this.g_a_H}g_aZx(e,a,_,g){0===e?(a=Math.max(Math.min(a/100,1),0),this.g_a_E[1]=a,this.g_a_G(this.g_a_I.gain,a,_,g),this.g_a_G(this.g_a_J.gain,1-a,_,g)):void 0}g_aZn(e,a,_){this.g_a_O=e,this.g_a_P=a,this.g_a_Q=_}g_aY$(){const e=super.g_aY$();return e.bufferOriginalUrl=this.g_a_O,e.bufferUrl="",e.bufferType=this.g_a_Q,e}},self.g_aZo=class extends a{constructor(_,a,g,t,n,e){super(_),this.g_ko="flanger",this.g_a_E=[a,g,t,n,e],this.g_a_H=this.g_a_F(),this.g_a_J=this.g_a_F(),this.g_a_J.gain.value=1-e/2,this.g_a_I=this.g_a_F(),this.g_a_I.gain.value=e/2,this.g_a_S=this.g_a_F(),this.g_a_S.gain.value=n,this.g_a_M=this.g_aXA.createDelay(a+g),this.g_a_M.delayTime.value=a,this.g_a_T=this.g_aXA.createOscillator(),this.g_a_T.frequency.value=t,this.g_a_U=this.g_a_F(),this.g_a_U.gain.value=g,this.g_a_H.connect(this.g_a_M),this.g_a_H.connect(this.g_a_J),this.g_a_M.connect(this.g_a_I),this.g_a_M.connect(this.g_a_S),this.g_a_S.connect(this.g_a_M),this.g_a_T.connect(this.g_a_U),this.g_a_U.connect(this.g_a_M.delayTime),this.g_a_T.start(0)}g_em(){this.g_a_T.stop(0),this.g_a_H.disconnect(),this.g_a_M.disconnect(),this.g_a_T.disconnect(),this.g_a_U.disconnect(),this.g_a_J.disconnect(),this.g_a_I.disconnect(),this.g_a_S.disconnect(),super.g_em()}g_aYx(e){this.g_a_I.disconnect(),this.g_a_I.connect(e),this.g_a_J.disconnect(),this.g_a_J.connect(e)}g_aYt(){return this.g_a_H}g_aZx(e,a,_,g){0===e?(a=Math.max(Math.min(a/100,1),0),this.g_a_E[4]=a,this.g_a_G(this.g_a_I.gain,a/2,_,g),this.g_a_G(this.g_a_J.gain,1-a/2,_,g)):6===e?(this.g_a_E[1]=a/1e3,this.g_a_G(this.g_a_U.gain,a/1e3,_,g)):7===e?(this.g_a_E[2]=a,this.g_a_G(this.g_a_T.frequency,a,_,g)):8===e?(this.g_a_E[3]=a/100,this.g_a_G(this.g_a_S.gain,a/100,_,g)):void 0}},self.g_aZp=class extends a{constructor(_,a,t,n,i,e,o){super(_),this.g_ko="phaser",this.g_a_E=[a,t,n,i,e,o],this.g_a_H=this.g_a_F(),this.g_a_J=this.g_a_F(),this.g_a_J.gain.value=1-o/2,this.g_a_I=this.g_a_F(),this.g_a_I.gain.value=o/2,this.g_a_K=this.g_aXA.createBiquadFilter(),this.g_a_K.type="allpass",this.g_a_K.frequency.value=a,this.g_a_K.detune.value=t,this.g_a_K.Q.value=n,this.g_a_T=this.g_aXA.createOscillator(),this.g_a_T.frequency.value=e,this.g_a_U=this.g_a_F(),this.g_a_U.gain.value=i,this.g_a_H.connect(this.g_a_K),this.g_a_H.connect(this.g_a_J),this.g_a_K.connect(this.g_a_I),this.g_a_T.connect(this.g_a_U),this.g_a_U.connect(this.g_a_K.frequency),this.g_a_T.start(0)}g_em(){this.g_a_T.stop(0),this.g_a_H.disconnect(),this.g_a_K.disconnect(),this.g_a_T.disconnect(),this.g_a_U.disconnect(),this.g_a_J.disconnect(),this.g_a_I.disconnect(),super.g_em()}g_aYx(e){this.g_a_I.disconnect(),this.g_a_I.connect(e),this.g_a_J.disconnect(),this.g_a_J.connect(e)}g_aYt(){return this.g_a_H}g_aZx(e,a,_,g){0===e?(a=Math.max(Math.min(a/100,1),0),this.g_a_E[5]=a,this.g_a_G(this.g_a_I.gain,a/2,_,g),this.g_a_G(this.g_a_J.gain,1-a/2,_,g)):1===e?(this.g_a_E[0]=a,this.g_a_G(this.g_a_K.frequency,a,_,g)):2===e?(this.g_a_E[1]=a,this.g_a_G(this.g_a_K.detune,a,_,g)):3===e?(this.g_a_E[2]=a,this.g_a_G(this.g_a_K.Q,a,_,g)):6===e?(this.g_a_E[3]=a,this.g_a_G(this.g_a_U.gain,a,_,g)):7===e?(this.g_a_E[4]=a,this.g_a_G(this.g_a_T.frequency,a,_,g)):void 0}},self.g_aZq=class extends a{constructor(e,a){super(e),this.g_ko="gain",this.g_a_E=[a],this.g_a_V=this.g_a_F(),this.g_a_V.gain.value=a}g_em(){this.g_a_V.disconnect(),super.g_em()}g_aYx(e){this.g_a_V.disconnect(),this.g_a_V.connect(e)}g_aYt(){return this.g_a_V}g_aZx(_,a,t,n){4===_?(this.g_a_E[0]=g(a),this.g_a_G(this.g_a_V.gain,g(a),t,n)):void 0}},self.g_aZr=class extends a{constructor(e,a,_){super(e),this.g_ko="tremolo",this.g_a_E=[a,_],this.g_a_V=this.g_a_F(),this.g_a_V.gain.value=1-_/2,this.g_a_T=this.g_aXA.createOscillator(),this.g_a_T.frequency.value=a,this.g_a_U=this.g_a_F(),this.g_a_U.gain.value=_/2,this.g_a_T.connect(this.g_a_U),this.g_a_U.connect(this.g_a_V.gain),this.g_a_T.start(0)}g_em(){this.g_a_T.stop(0),this.g_a_T.disconnect(),this.g_a_U.disconnect(),this.g_a_V.disconnect(),super.g_em()}g_aYx(e){this.g_a_V.disconnect(),this.g_a_V.connect(e)}g_aYt(){return this.g_a_V}g_aZx(e,a,_,g){0===e?(a=Math.max(Math.min(a/100,1),0),this.g_a_E[1]=a,this.g_a_G(this.g_a_V.gain.value,1-a/2,_,g),this.g_a_G(this.g_a_U.gain.value,a/2,_,g)):7===e?(this.g_a_E[0]=a,this.g_a_G(this.g_a_T.frequency,a,_,g)):void 0}},self.g_aZs=class extends a{constructor(e,a,_){super(e),this.g_ko="ringmod",this.g_a_E=[a,_],this.g_a_H=this.g_a_F(),this.g_a_I=this.g_a_F(),this.g_a_I.gain.value=_,this.g_a_J=this.g_a_F(),this.g_a_J.gain.value=1-_,this.g_a_W=this.g_a_F(),this.g_a_W.gain.value=0,this.g_a_T=this.g_aXA.createOscillator(),this.g_a_T.frequency.value=a,this.g_a_T.connect(this.g_a_W.gain),this.g_a_T.start(0),this.g_a_H.connect(this.g_a_W),this.g_a_H.connect(this.g_a_J),this.g_a_W.connect(this.g_a_I)}g_em(){this.g_a_T.stop(0),this.g_a_T.disconnect(),this.g_a_W.disconnect(),this.g_a_H.disconnect(),this.g_a_I.disconnect(),this.g_a_J.disconnect(),super.g_em()}g_aYx(e){this.g_a_I.disconnect(),this.g_a_I.connect(e),this.g_a_J.disconnect(),this.g_a_J.connect(e)}g_aYt(){return this.g_a_H}g_aZx(e,a,_,g){0===e?(a=Math.max(Math.min(a/100,1),0),this.g_a_E[1]=a,this.g_a_G(this.g_a_I.gain,a,_,g),this.g_a_G(this.g_a_J.gain,1-a,_,g)):7===e?(this.g_a_E[0]=a,this.g_a_G(this.g_a_T.frequency,a,_,g)):void 0}},self.g_aZt=class extends a{constructor(_,a,g,t,n,e){super(_),this.g_ko="distortion",this.g_a_E=[a,g,t,n,e],this.g_a_H=this.g_a_F(),this.g_a_X=this.g_a_F(),this.g_a_Y=this.g_a_F(),this.g_a_Z(t,n),this.g_a_I=this.g_a_F(),this.g_a_I.gain.value=e,this.g_a_J=this.g_a_F(),this.g_a_J.gain.value=1-e,this.g_a__=this.g_aXA.createWaveShaper(),this.g_a_$=new Float32Array(65536),this.g_a$a(a,g),this.g_a__.curve=this.g_a_$,this.g_a_H.connect(this.g_a_X),this.g_a_H.connect(this.g_a_J),this.g_a_X.connect(this.g_a__),this.g_a__.connect(this.g_a_Y),this.g_a_Y.connect(this.g_a_I)}g_em(){this.g_a_H.disconnect(),this.g_a_X.disconnect(),this.g_a__.disconnect(),this.g_a_Y.disconnect(),this.g_a_I.disconnect(),this.g_a_J.disconnect(),super.g_em()}g_a_Z(e,_){.01>e&&(e=.01),this.g_a_X.gain.value=e,this.g_a_Y.gain.value=Math.pow(1/e,.6)*_}g_a$a(e,a){for(let _,g=0;32768>g;++g)_=g/32768,_=this.g_a$b(_,e,a),this.g_a_$[32768+g]=_,this.g_a_$[32768-g-1]=-_}g_a$b(e,a,_){const t=1.05*_*a-a,n=0>e?-1:1,o=0>e?-e:e;let g=o<a?o:a+t*i(o-a,1/t);return g*=n,g}g_aYx(e){this.g_a_I.disconnect(),this.g_a_I.connect(e),this.g_a_J.disconnect(),this.g_a_J.connect(e)}g_aYt(){return this.g_a_H}g_aZx(e,a,_,g){0===e?(a=Math.max(Math.min(a/100,1),0),this.g_a_E[4]=a,this.g_a_G(this.g_a_I.gain,a,_,g),this.g_a_G(this.g_a_J.gain,1-a,_,g)):void 0}},self.g_aZu=class extends a{constructor(_,a,g,t,n,e){super(_),this.g_ko="compressor",this.g_a_E=[a,g,t,n,e],this.g_a_V=this.g_aXA.createDynamicsCompressor(),this.g_a_V.threshold.value=a,this.g_a_V.knee.value=g,this.g_a_V.ratio.value=t,this.g_a_V.attack.value=n,this.g_a_V.release.value=e}g_em(){this.g_a_V.disconnect(),super.g_em()}g_aYx(e){this.g_a_V.disconnect(),this.g_a_V.connect(e)}g_aYt(){return this.g_a_V}g_aZx(){}},self.g_aZv=class extends a{constructor(e,a,_){super(e),this.g_ko="analyser",this.g_a_E=[a,_],this.g_a_V=this.g_aXA.createAnalyser(),this.g_a_V.fftSize=a,this.g_a_V.smoothingTimeConstant=_,this.g_a$c=new Float32Array(this.g_a_V.frequencyBinCount),this.g_a$d=new Uint8Array(a),this.g_a$e=0,this.g_a$f=0,this.g_aZE.g_aZy(this)}g_em(){this.g_aZE.g_aZz(this),this.g_a_V.disconnect(),super.g_em()}g_Jj(){this.g_a_V.getFloatFrequencyData(this.g_a$c),this.g_a_V.getByteTimeDomainData(this.g_a$d);const e=this.g_a_V.fftSize;this.g_a$e=0;let a=0;for(let _,g=0;g<e;++g)_=(this.g_a$d[g]-128)/128,0>_&&(_=-_),this.g_a$e<_&&(this.g_a$e=_),a+=_*_;this.g_a$e=n(this.g_a$e),this.g_a$f=n(Math.sqrt(a/e))}g_aYx(e){this.g_a_V.disconnect(),this.g_a_V.connect(e)}g_aYt(){return this.g_a_V}g_aZx(){}g_aZa(){return{tag:this.g_aYP(),index:this.g_Dl(),peak:this.g_a$e,rms:this.g_a$f,binCount:this.g_a_V.frequencyBinCount,freqBins:this.g_a$c}}}}{function e(e){return new Promise(a=>setTimeout(a,e))}const a=class extends g_aUJ{constructor(e){super(e,"instant-games"),this.g_a$g=!1,this.g_aIG=!1,this.g_a$h=null,this.g_a$i=null,this.g_a$j=null,this.g_aUW([["load",e=>this.g_a$k(e)],["loading-progress",e=>this.g_aIX(e)],["start-game",()=>this.g_a$l()],["quit",()=>this.g_a$m()],["set-player-data",e=>this.g_a$n(e)],["load-player-data",()=>this.g_a$o()],["share",e=>this.g_a$p(e)],["custom-update",e=>this.g_a$q(e)],["switch-game",e=>this.g_a$r(e)],["change-context",e=>this.g_a$s(e)],["log-event",e=>this.g_a$t(e)],["load-connected-players",()=>this.g_a$u()],["set-score",e=>this.g_a$v(e)],["load-player-score",e=>this.g_a$w(e)],["share-leaderboard-update",e=>this.g_a$x(e)],["load-leaderboard",e=>this.g_a$y(e)],["create-shortcut",()=>this.g_a$z()],["subscribe-bot",()=>this.g_a$A()],["load-ad",e=>this.g_a$B(e)],["show-ad",e=>this.g_a$C(e)]])}async g_a$k(a){return"instant-games"===a.exportType?(this.g_a$h=window.FBInstant,!!this.g_a$h)&&(await Promise.race([this.g_a$D(),e(4e3)]),this.g_aIG=this.g_a$g,this.g_aIG?console.info("[Instant Games] Initialized OK"):console.warn("[Instant Games] Initialization timed out after 4 seconds. Continuing with Instant Games disabled."),this.g_aIG):(console.warn("[Instant Games] Project has not been exported with the 'Instant Games' export option, so Instant Games features will be unavailable"),!1)}async g_a$D(){try{await this.g_a$h.initializeAsync(),this.g_a$g=!0}catch(e){console.error("[Instant Games] Failed to initialize: ",e)}}g_aIX(e){this.g_aIG&&this.g_a$h.setLoadingProgress(e.progress)}async g_a$l(){if(!this.g_aIG)return null;const _=this.g_a$h;await _.startGameAsync(),_.onPause(()=>this.g_aUN("pause"));const a=_.context,g=_.player,t=_.getEntryPointData();let n="";return t&&t.hasOwnProperty("data")&&(n=t.data),{locale:_.getLocale(),platform:_.getPlatform(),sdkVersion:_.getSDKVersion(),contextId:a.getID(),contextType:a.getType(),playerName:g.getName(),playerPhoto:g.getPhoto(),playerId:g.getID(),entryPointData:n,supportedApis:_.getSupportedAPIs()}}g_a$E(){this.g_aUN("error")}g_a$m(){this.g_aIG&&this.g_a$h.quit()}async g_a$n(e){if(this.g_aIG)try{await this.g_a$h.player.setDataAsync({data:e.data})}catch(e){console.error("[Instant Games] Failed to set player data: ",e),this.g_a$E()}}async g_a$o(){if(!this.g_aIG)return"";try{const e=await this.g_a$h.player.getDataAsync(["data"]);if(e&&e.hasOwnProperty("data"))return e.data}catch(e){console.error("[Instant Games] Failed to load player data: ",e),this.g_a$E()}return""}async g_a$p(e){if(this.g_aIG)try{await this.g_a$h.shareAsync({intent:e.intent,image:e.image,text:e.text,data:{data:e.data}})}catch(e){console.error("[Instant Games] Failed to share: ",e),this.g_a$E()}}async g_a$q(e){if(this.g_aIG)try{const a={action:"CUSTOM",template:e.templateId,image:e.image,text:e.text,data:{data:e.data},strategy:e.strategy,notification:e.notification},_=e.cta;_&&(a.cta=_),await this.g_a$h.updateAsync(a)}catch(e){console.error("[Instant Games] Error posting custom update: ",e)}}async g_a$r(e){if(this.g_aIG)try{await this.g_a$h.switchGameAsync(e.appId,{data:e.data})}catch(e){console.error("[Instant Games] Failed to switch game: ",e),this.g_a$E()}}async g_a$s(_){if(!this.g_aIG)return{isOk:!1};try{const a={},g=_.filter;1===g?a.filters=["NEW_CONTEXT_ONLY"]:2===g?a.filters=["INCLUDE_EXISTING_CHALLENGES"]:3===g&&(a.filters=["NEW_PLAYERS_ONLY"]);const t=_.minSize,n=_.maxSize;0<=t&&(a.minSize=t),0<=n&&(a.maxSize=n);const e=this.g_a$h.context;return await e.chooseAsync(a),{isOk:!0,newContextId:e.getID(),newContextType:e.getType()}}catch(e){return"USER_INPUT"===e.code?{isOk:!1,cancelled:!0}:(console.warn("[Instant Games] Failed to change context: ",e),{isOk:!1})}}g_a$t(e){this.g_aIG&&this.g_a$h.logEvent(e.name,e.valueToSum)}async g_a$u(){if(!this.g_aIG)return{isOk:!1};try{const e=await this.g_a$h.player.getConnectedPlayersAsync();return{isOk:!0,connectedPlayers:e.map(e=>({id:e.getID(),name:e.getName(),photo:e.getPhoto()}))}}catch(e){return console.error("[Instant Games] Failed to share: ",e),this.g_a$E(),{isOk:!1}}}async g_a$v(e){if(!this.g_aIG)return!1;try{const a=await this.g_a$h.getLeaderboardAsync(e.leaderboardId);return await a.setScoreAsync(e.score),!0}catch(e){return console.error("[Instant Games] Failed to set score: ",e),this.g_a$E(),!1}}async g_a$w(e){if(!this.g_aIG)return{isOk:!1};try{const a=await this.g_a$h.getLeaderboardAsync(e.leaderboardId),_=await a.getPlayerEntryAsync();return{isOk:!0,score:_.getScore(),rank:_.getRank()}}catch(e){return console.error("[Instant Games] Failed to load player score: ",e),this.g_a$E(),{isOk:!1}}}async g_a$x(e){if(this.g_aIG)try{await this.g_a$h.updateAsync({action:"LEADERBOARD",name:e.leaderboardId})}catch(e){console.error("[Instant Games] Failed to share leaderboard update: ",e)}}async g_a$y(_){if(!this.g_aIG)return{isOk:!1};const a=_.count,g=_.offset;try{const t=await this.g_a$h.getLeaderboardAsync(_.leaderboardId);let n;return n=0===_.results?await t.getEntriesAsync(a,g):await t.getConnectedPlayerEntriesAsync(a,g),{isOk:!0,leaderboardEntries:n.map(e=>({score:e.getScore(),rank:e.getRank(),playerName:e.getPlayer().getName(),playerPhoto:e.getPlayer().getPhoto()}))}}catch(e){return console.error("[Instant Games] Failed to load leaderboard: ",e),this.g_a$E(),{isOk:!1}}}async g_a$z(){if(!this.g_aIG)return!1;try{const e=await this.g_a$h.canCreateShortcutAsync();return!!e&&(await this.g_a$h.createShortcutAsync(),!0)}catch(e){return console.error("[Instant Games] Failed to create shortcut: ",e),!1}}async g_a$A(){if(this.g_aIG){const e=this.g_a$h.player;try{const a=await e.canSubscribeBotAsync();if(!a)throw new Error("not allowed by canSubscribeBotAsync()");await e.subscribeBotAsync(),console.log("[Instant Games] Successfully subscribed to bot")}catch(e){console.error("[Instant Games] Failed to subscribe bot: ",e)}}}async g_a$B(e){if(!this.g_aIG)return!1;const a=e.placementId;try{const _=0===e.type;let g;return g=_?await this.g_a$h.getInterstitialAdAsync(a):await this.g_a$h.getRewardedVideoAsync(a),await g.loadAsync(),_?this.g_a$i=g:this.g_a$j=g,!0}catch(e){return console.error("[Instant Games] Failed to load ad: ",e),!1}}async g_a$C(e){if(!this.g_aIG)return!1;const a=0===e.type?this.g_a$i:this.g_a$j;if(!a)return!1;try{return await a.showAsync(),!0}catch(e){return console.error("[Instant Games] Failed to show ad: ",e),!1}}};g_aVq.g_aWm(a)}{const e=class extends g_aUJ{constructor(e){super(e,"facebook"),this.g_aIG=!1,this.g_a$F=null,this.g_aKd="",this.g_aKe=!1,this.g_aKf="",this.g_aKg="",this.g_aKh="",this.g_aKi="",this.g_aKj="",this.g_aZT=null,window.fbAsyncInit=()=>this.g_a$G(),this.g_aUW([["load",e=>this.g_a$k(e)],["login",e=>this.g_a$H(e)],["logout",()=>this.g_a$I()],["prompt-wall-post",()=>this.g_a$J()],["prompt-share-app",()=>this.g_a$K()],["prompt-share-link",e=>this.g_a$L(e)],["publish-to-wall",e=>this.g_a$M(e)],["publish-link",e=>this.g_a$N(e)],["on-cta-click",()=>this.g_a$O()]])}async g_a$k(e){if(this.g_aKd=e.appId,!this.g_aKd)return console.log("[Facebook] No App ID provided. Please enter an App ID before using the object."),!1;try{return await this.g_a$P(),!0}catch(e){return console.error("[Facebook] Error loading Facebook API: ",e),!1}}g_a$P(){return new Promise((e,a)=>{if(document.getElementById("facebook-jssdk"))return void e();this.g_aZT=e;const _=document.createElement("script");_.id="facebook-jssdk",_.onerror=a,_.async=!0,_.src="//connect.facebook.net/en_US/sdk.js",document.getElementsByTagName("head")[0].appendChild(_)})}g_a$G(){this.g_a$F=window.FB;let e=location.pathname;"/"!==e.substr(e.length-1)&&(e=e.substr(0,e.lastIndexOf("/")+1)),this.g_a$F.init({version:"v3.0",appId:this.g_aKd,status:!0,cookie:!0,xfbml:!1}),this.g_a$F.Event.subscribe("auth.login",e=>this.g_aKl(e)),this.g_a$F.Event.subscribe("auth.logout",e=>this.g_aKn(e)),this.g_a$F.getLoginStatus(e=>this.g_aKl(e)),this.g_aIG=!0,this.g_aZT&&(this.g_aZT(),this.g_aZT=null)}g_aKl(e){!e.authResponse||this.g_aKe||(this.g_aKe=!0,this.g_aKf=e.authResponse.userID,console.log("[Facebook] Logged in as user ID: "+this.g_aKf),this.g_aKg=e.authResponse.accessToken,this.g_aUN("login",{userId:this.g_aKf,accessToken:this.g_aKg}),this.g_a$F.api("/me?fields=name,first_name,last_name",e=>{this.g_aKh=e.name,this.g_aKi=e.first_name,this.g_aKj=e.last_name,this.g_aUN("name-available",{fullName:this.g_aKh,firstName:this.g_aKi,lastName:this.g_aKj})}))}g_aKn(){this.g_aKe=!1,this.g_aKg="",this.g_aKh="",this.g_aKi="",this.g_aKj="",this.g_aUN("logout")}g_a$H(e){if(!this.g_aKe){const a=e.permissions;this.g_a$F.login(e=>this.g_aKl(e),{scope:a})}}g_a$I(){this.g_aKe&&this.g_a$F.logout(()=>{})}g_a$J(){this.g_aKe&&this.g_a$F.ui({method:"feed"},e=>{e&&e.error&&console.error("[Facebook] Error prompting wall post: ",e.error)})}g_a$K(){this.g_aKe&&this.g_a$F.ui({method:"feed",link:"https://apps.facebook.com/"+this.g_aKd+"/"},e=>{e&&e.error&&console.error("[Facebook] Error prompting to share app: ",e.error)})}g_a$L(e){this.g_aKe&&this.g_a$F.ui({method:"feed",link:e.url},e=>{e&&e.error&&console.error("[Facebook] Error prompting to share link: ",e.error)})}g_a$M(e){if(this.g_aKe){const a={method:"stream.publish",message:e.message};FB.api("/me/feed","POST",a,e=>{e&&e.error&&console.error("[Facebook] Error publishing to wall: ",e.error)})}}g_a$N(e){if(this.g_aKe){const a={method:"stream.publish",message:e.message,link:e.url,name:e.name,caption:e.caption,description:e.description};e.picture&&(a.picture=e.picture),FB.api("/me/feed","POST",a,e=>{e&&e.error&&console.error("[Facebook] Error publishing link: ",e.error)})}}g_a$O(){self.FbPlayableAd&&self.FbPlayableAd.onCTAClick?(console.log("[Facebook] CTA clicked: calling FbPlayableAd.onCTAClick()"),self.FbPlayableAd.onCTAClick()):console.warn("[Facebook] CTA clicked: FbPlayableAd.onCTAClick() function not available - check running as a Playable Ad")}};g_aVq.g_aWm(e)}